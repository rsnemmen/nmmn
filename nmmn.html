
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>nmmn package &#8212; nmmn  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="nmmn" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="nmmn-package">
<h1>nmmn package<a class="headerlink" href="#nmmn-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-nmmn.astro">
<span id="nmmn-astro-module"></span><h2>nmmn.astro module<a class="headerlink" href="#module-nmmn.astro" title="Permalink to this headline">¶</a></h2>
<section id="astrophysical-routines">
<h3>Astrophysical routines<a class="headerlink" href="#astrophysical-routines" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="nmmn.astro.Constants">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmmn.astro.</span></span><span class="sig-name descname"><span class="pre">Constants</span></span><a class="reference internal" href="_modules/nmmn/astro.html#Constants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.astro.Constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a set of useful constants in CGS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">astro</span><span class="o">.</span><span class="n">Constants</span><span class="p">()</span>
<span class="n">E</span><span class="o">=</span><span class="n">mass</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.astro.arcsec2pc">
<span class="sig-prename descclassname"><span class="pre">nmmn.astro.</span></span><span class="sig-name descname"><span class="pre">arcsec2pc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/astro.html#arcsec2pc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.astro.arcsec2pc" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the input angular size and distance to the object, computes
the corresponding linear size in pc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> – distance in Mpc</p></li>
<li><p><strong>a</strong> – angular size in arcsec</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>linear size in pc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.astro.dist2z">
<span class="sig-prename descclassname"><span class="pre">nmmn.astro.</span></span><span class="sig-name descname"><span class="pre">dist2z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/astro.html#dist2z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.astro.dist2z" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts luminosity distance to redshift by solving the equation
‘d-z=0’.</p>
<p>Input is assumed float.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.astro.freq">
<span class="sig-prename descclassname"><span class="pre">nmmn.astro.</span></span><span class="sig-name descname"><span class="pre">freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/astro.html#freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.astro.freq" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert array of periods in days to frequencies in Hz.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.astro.mjy">
<span class="sig-prename descclassname"><span class="pre">nmmn.astro.</span></span><span class="sig-name descname"><span class="pre">mjy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lognu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/astro.html#mjy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.astro.mjy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts log(nu/Hz), log(nu Lnu [erg/s]), error in log(nuLnu) to
log(lambda/micron), log(Fnu/mJy), error in log(Fnu).
The input units are CGS.</p>
<p>Usage:
If you have errors in the flux:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lamb</span><span class="p">,</span><span class="n">fnu</span><span class="p">,</span><span class="n">ferr</span><span class="o">=</span><span class="n">mjy</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">dist</span><span class="p">,</span><span class="n">yerr</span><span class="p">)</span>
</pre></div>
</div>
<p>If you do not have errors in the flux:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lamb</span><span class="p">,</span><span class="n">fnu</span><span class="o">=</span><span class="n">mjy</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dist</strong> – distance in Mpc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.astro.period">
<span class="sig-prename descclassname"><span class="pre">nmmn.astro.</span></span><span class="sig-name descname"><span class="pre">period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/astro.html#period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.astro.period" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert array of frequencies to periods.</p>
</dd></dl>

</section>
</section>
<section id="module-nmmn.bayes">
<span id="nmmn-bayes-module"></span><h2>nmmn.bayes module<a class="headerlink" href="#module-nmmn.bayes" title="Permalink to this headline">¶</a></h2>
<section id="methods-for-dealing-with-bayesian-statistics">
<h3>Methods for dealing with Bayesian statistics<a class="headerlink" href="#methods-for-dealing-with-bayesian-statistics" title="Permalink to this headline">¶</a></h3>
<p>e.g. priors, posteriors, joint density plots.</p>
<p>Right now the module is focused around PyMC, but I am migrating
to emcee.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>plot confidence/credibility interval of a model</p>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.bayes.allplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.bayes.</span></span><span class="sig-name descname"><span class="pre">allplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/bayes.html#allplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.bayes.allplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Input:
X,Y : objects referring to the variables produced by PyMC that you want
to analyze. Example: X=M.theta, Y=M.slope.</p>
<p>Inherited from Tommy LE BLANC’s code at astroplotlib|STSCI.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.bayes.joint_density">
<span class="sig-prename descclassname"><span class="pre">nmmn.bayes.</span></span><span class="sig-name descname"><span class="pre">joint_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/bayes.html#joint_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.bayes.joint_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots joint distribution of variables.
Inherited from method in src/graphics.py module in project 
git://github.com/aflaxman/pymc-example-tfr-hdi.git</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.bayes.jointplotx">
<span class="sig-prename descclassname"><span class="pre">nmmn.bayes.</span></span><span class="sig-name descname"><span class="pre">jointplotx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binscon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/bayes.html#jointplotx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.bayes.jointplotx" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the joint distribution of posteriors for X1 and X2, including the 1D
histograms showing the median and standard deviations. Uses simple method
for drawing the confidence contours compared to jointplot (which is wrong).</p>
<p>The work that went in creating this method is shown, step by step, in 
the ipython notebook “error contours.ipynb”. Sources of inspiration:
- <a class="reference external" href="http://python4mpia.github.io/intro/quick-tour.html">http://python4mpia.github.io/intro/quick-tour.html</a></p>
<p>Usage:
&gt;&gt;&gt; jointplot(M.rtr.trace(),M.mdot.trace(),xlabel=’$log r_{rm tr}$’, ylabel=’$log dot{m}$’)</p>
</dd></dl>

</section>
</section>
<section id="module-nmmn.dsp">
<span id="nmmn-dsp-module"></span><h2>nmmn.dsp module<a class="headerlink" href="#module-nmmn.dsp" title="Permalink to this headline">¶</a></h2>
<section id="signal-processing">
<h3>Signal processing<a class="headerlink" href="#signal-processing" title="Permalink to this headline">¶</a></h3>
<p>Mostly time series.</p>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.cwt">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">cwt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#cwt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.cwt" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the time and flux (sig), this method computes a continuous 
wavelet transform (CWT).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Deprecated.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.cwt_spectra">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">cwt_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#cwt_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.cwt_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes CWT power spectrum, find peaks, produces arrays for
plotting images showing the spectral lines. Note that the CWT power spectrum
is an average from the CWT power array. Therefore, they are a smoothed out 
version of a Fourier spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – array of times</p></li>
<li><p><strong>var</strong> – array of signal</p></li>
<li><p><strong>n</strong> – number of vertical elements in image that will be created showing spectral lines</p></li>
<li><p><strong>thres</strong> – threshold parameter for finding peaks in time series</p></li>
</ul>
</dd>
</dl>
<p>Usage: <code class="docutils literal notranslate"><span class="pre">N,P,l,pp,power=cwt_spectra(t,y,thres=0.3)</span></code></p>
<p>Returns the following variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code>: 2d number of vertical elements for plotting the spectra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code>: 2d periods</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code>: 2d power spectra for plotting images</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pp</span></code>: periods corresponding to peaks (peak period) in power spectrum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">power</span></code>: peaks in CWT power spectrum</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.dt">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes difference between consecutive points in the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – input times</p></li>
<li><p><strong>y</strong> – input y-values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.error_resampler">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">error_resampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">errors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#error_resampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.error_resampler" title="Permalink to this definition">¶</a></dt>
<dd><p>For use with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<p>Method for performing the proper <code class="docutils literal notranslate"><span class="pre">mean</span></code> resampling of the <em>uncertainties</em> (error bars) 
in the time series with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. Note that doing a simple resampling 
will fail to propagate uncertainties, since error in the mean goes as</p>
<div class="math notranslate nohighlight">
\[\sigma=\sqrt{\Sigma_n \sigma_n^2}\]</div>
<p>Example: Resamples the errors with 30 day averages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># df[&#39;errflux&#39;] has the 1sigma uncertainties</span>
<span class="n">err</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;errflux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;30d&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">nmmn</span><span class="o">.</span><span class="n">dsp</span><span class="o">.</span><span class="n">error_resampler</span><span class="p">)</span> 

<span class="c1"># plot y-values (df[&#39;flux&#39;]) with errors (err)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;30d&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yerr</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.ls">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.ls" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and plot Lomb-Scargle periodogram for a given timeseries. 
Returns arrays with periods and LS spectral power.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">power</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">values</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>periods, spectral power</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.ls_spectra">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">ls_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#ls_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.ls_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes Lomb-Scargle power spectrum, find peaks, produces arrays for
plotting images showing the spectral lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – array of times</p></li>
<li><p><strong>var</strong> – array of signal</p></li>
<li><p><strong>n</strong> – number of vertical elements in image that will be created showing spectral lines</p></li>
<li><p><strong>thres</strong> – threshold parameter for finding peaks in time series</p></li>
<li><p><strong>smooth</strong> – number of points in the smoothing window. If 0, no smoothing</p></li>
</ul>
</dd>
</dl>
<p>Usage: <code class="docutils literal notranslate"><span class="pre">N,P,l,pp,power=ls_spectra(t,y,thres=0.3)</span></code></p>
<p>Returns the following variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code>: 2d number of vertical elements for plotting the spectra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code>: 2d periods</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code>: 2d power spectra for plotting images</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pp</span></code>: periods corresponding to peaks (peak period) in power spectrum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">power</span></code>: peaks in power spectrum</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.peaks">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects the peaks in the time series given by Y (and X if provided).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> – time series input arrays</p></li>
<li><p><strong>what</strong> – select what you want – max/0 or min/1 peaks returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>xmax,ymax – arrays with max peaks in the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.reconstruct">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.reconstruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to reconstruct a time series (TS) signal based on its CWT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wa</strong> – wavelet object generated with <cite>wavelets</cite> module</p></li>
<li><p><strong>i</strong> – index array containing only the elements that will be excluded from the signal reconstruction. i.e. the elements indicated by <code class="docutils literal notranslate"><span class="pre">i</span></code> will zeroed in the CWT complex array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>full reconstructed TS, reconstructed CWT power array, reconstructed CWT complex array, detrended reconstructed TS</p>
</dd>
</dl>
<p>Examples:</p>
<p>1. Compute the CWT for TS in <code class="docutils literal notranslate"><span class="pre">var</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wavelets</span>

<span class="c1"># compute CWT</span>
<span class="n">wa</span> <span class="o">=</span> <span class="n">wavelets</span><span class="o">.</span><span class="n">WaveletAnalysis</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="c1"># time and period 2D arrays</span>
<span class="n">T</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">wa</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">wa</span><span class="o">.</span><span class="n">scales</span><span class="p">)</span>
</pre></div>
</div>
<p>2. Reconstruct the signal, throwing out all periods with values between 1000 and 2000:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">j</span><span class="o">=</span><span class="n">where</span><span class="p">((</span><span class="n">S</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">S</span><span class="o">&gt;</span><span class="mi">2000</span><span class="p">))</span>
<span class="n">recdet</span><span class="p">,</span><span class="n">rec</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">dsp</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">wa</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
</pre></div>
</div>
<p>3. Plots the reconstructed signal along with the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;reconstructed signal&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">recdet</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pure reconstructed signal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.reconstruct_period">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">reconstruct_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#reconstruct_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.reconstruct_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns reconstructed detrended signal from CWT, considering only the interval
between the two given periods.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.smooth">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth the data using a window with requested size.
Copied from <a class="reference external" href="http://wiki.scipy.org/Cookbook/SignalSmooth">http://wiki.scipy.org/Cookbook/SignalSmooth</a></p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal 
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – the input signal</p></li>
<li><p><strong>window_len</strong> – the dimension of the smoothing window; should be an odd integer</p></li>
<li><p><strong>window</strong> – the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’     flat window will produce a moving average smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the smoothed signal</p>
</dd>
</dl>
<p>Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">*</span><span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">=</span><span class="n">smooth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>numpy.hanning, numpy.hamming, numpy.bartlett, numpy.blackman, numpy.convolve, scipy.signal.lfilter</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>length(output) != length(input), to correct this: return y[(window_len/2-1):-(window_len/2)] instead of just y.</p>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>the window parameter could be the window itself if an array instead of a string</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.smoothxy">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">smoothxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#smoothxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.smoothxy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – “time” in the time series</p></li>
<li><p><strong>y</strong> – y variable</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>smoothed y and corresponding x arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.sumts">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">sumts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#sumts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.sumts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two time series, this method returns their sum.</p>
<p>n = number of points in the final TS, as a multiple of the sum of points
in both TS.</p>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>defines a uniform t-array with the number of total elements of the two arrays</p></li>
<li><p>interpolates both TS in this new t-array</p></li>
<li><p>sums their values</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.uneven2even">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">uneven2even</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#uneven2even"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.uneven2even" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an uneven timeseries (TS) with multiple values defined at the same 
time, this method will convert it into an evenly sampled
timeseries with a dt as close as possible to the actual dt, removing
duplicate-t values.</p>
<p>Example: suppose you want to compute the CWT for an unevenly sampled
time series. Since the CWT does not support uneven TS, you can first
call this method to regularize your TS and then perform the TS.</p>
<p>Algorithm:</p>
<ul class="simple">
<li><p>REMOVE DUPLICATE times</p></li>
<li><p>CREATE REGULAR GRID USING BEST DT</p></li>
<li><p>INTERPOLATE NEW TS ON PREVIOUS ONE</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – input times</p></li>
<li><p><strong>y</strong> – input value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.dsp.varsig">
<span class="sig-prename descclassname"><span class="pre">nmmn.dsp.</span></span><span class="sig-name descname"><span class="pre">varsig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/dsp.html#varsig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.dsp.varsig" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantifies significance of variability of time series, taking into 
account the uncertainties.</p>
<p>Given the time series signal <em>y</em> and the corresponding uncertainties
<span class="math notranslate nohighlight">\(\sigma y\)</span>, the test statistics <em>T</em> is defined as</p>
<div class="math notranslate nohighlight">
\[T \equiv \frac{y_{i+1}-y_i}{\sigma y_i}.\]</div>
<p><em>T</em> will give the significance of variability at each point in time,
in standard deviations of the preceding noise point.</p>
<p><strong>Usage:</strong></p>
<p>Computes TS and plots time series, highlighting the 1sigma variability
interval in gray:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">=</span><span class="n">varsig</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span><span class="n">errflux</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">ones_like</span><span class="p">(</span><span class="n">tdec</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">ones_like</span><span class="p">(</span><span class="n">tdec</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>generalize to arbitrary windows of time</p>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>propagate uncertainty</p>
</div>
</dd></dl>

</section>
</section>
<section id="module-nmmn.fermi">
<span id="nmmn-fermi-module"></span><h2>nmmn.fermi module<a class="headerlink" href="#module-nmmn.fermi" title="Permalink to this headline">¶</a></h2>
<section id="methods-to-handle-fermi-lat-data">
<h3>Methods to handle Fermi LAT data<a class="headerlink" href="#methods-to-handle-fermi-lat-data" title="Permalink to this headline">¶</a></h3>
<p>Handle output of Fermi analysis.</p>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.PixelFile">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">PixelFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#PixelFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.PixelFile" title="Permalink to this definition">¶</a></dt>
<dd><p>return the name of a file where the result of 1 pixel 
evaluation will be stored</p>
<p>From enrico/tsmap.py.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.converttime">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">converttime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#converttime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.converttime" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from MET Fermi time to a python datetime tuple.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convertyear</span><span class="p">(</span><span class="mi">386817828</span><span class="p">)</span>
</pre></div>
</div>
<p>returns datetime.datetime(2013, 4, 5, 1, 23, 48).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> – a float or array of floats</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a datetime structure (or list) with the date corresponding to the input float or array</p>
</dd>
</dl>
<p>y is the amount of seconds since 2001.0 UTC. Beware that my method
may assume that all years have 365 days.</p>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://stackoverflow.com/questions/19305991/convert-fractional-years-to-a-real-date-in-python">http://stackoverflow.com/questions/19305991/convert-fractional-years-to-a-real-date-in-python</a></p></li>
<li><p><a class="reference external" href="http://heasarc.gsfc.nasa.gov/cgi-bin/Tools/xTime/xTime.pl">http://heasarc.gsfc.nasa.gov/cgi-bin/Tools/xTime/xTime.pl</a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.getconfig">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">getconfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'analysis.conf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#getconfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.getconfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads config file and gets parameters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.plotMap">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">plotMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#plotMap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.plotMap" title="Permalink to this definition">¶</a></dt>
<dd><p>This method plots some count map. Inherited from the method plotMaps
above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> – FITS file with counts to be plotted</p></li>
<li><p><strong>cmap</strong> – desired colormap for image</p></li>
<li><p><strong>roi</strong> – DS9 region file if present, otherwise leave None</p></li>
<li><p><strong>out</strong> – output filename and format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image file ‘tmp.png’ in the source folder.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.plotMaps">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">plotMaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'analysis.conf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#plotMaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.plotMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the directory where the results of an Enrico analysis are 
located (enrico_sed), this method plots the different count maps
(observed, model and residuals).</p>
<p>This is the fixed version of the script plotMaps.py from the Enrico
distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>configdir</strong> – directory with “/” at the end that points to the place</p>
</dd>
</dl>
<p>where Enrico output files are located.
:returns: image file SOURCE_Maps.png in the source folder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.plotTSmap">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">plotTSmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'analysis.conf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#plotTSmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.plotTSmap" title="Permalink to this definition">¶</a></dt>
<dd><p>From Enrico/tsmap.py.</p>
<p>Gather the results of the evaluation of 
each pixel and fill a fits file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.fermi.starttime">
<span class="sig-prename descclassname"><span class="pre">nmmn.fermi.</span></span><span class="sig-name descname"><span class="pre">starttime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/fermi.html#starttime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.fermi.starttime" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes the start time of observations taken with LAT. This assumes that the
time array in your light curve is in days already, and the beginning of
your analysis coincides with t0 for LAT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> – array with input times given in days, with t0 coinciding with the beginning of LAT</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>t (days), t (years)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-nmmn.grmhd">
<span id="nmmn-grmhd-module"></span><h2>nmmn.grmhd module<a class="headerlink" href="#module-nmmn.grmhd" title="Permalink to this headline">¶</a></h2>
<section id="dealing-with-gr-r-m-hd-simulations">
<h3>Dealing with (GR)(R)(M)HD simulations<a class="headerlink" href="#dealing-with-gr-r-m-hd-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>RAISHIN</p></li>
<li><p>Pluto</p></li>
<li><p>HARM</p></li>
</ul>
<p>See jupyter notebooks “grmhd*” for examples on how to use this
module.</p>
<p>TODO:</p>
<ul class="simple">
<li><p>[ ] incorporate Pluto class from pluto-tools</p></li>
<li><p>[ ]</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">Harm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gdump'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that reads a HARM dump datafile and converts to numpy format
for plotting with matplotlib, mayavi etc. Heavily inspired/copied from
harm_script.py.</p>
<p>Reads data from a harm dump file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">grmhd</span><span class="o">.</span><span class="n">Harm</span><span class="p">(</span><span class="s2">&quot;dump019&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>d</cite> object will then have several attributes related to the 
dump physical fields, grid and coordinate information.</p>
<p>Inspect densities:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">rho</span>
</pre></div>
</div>
<p>Convert arrays to cartesian coordinates for plotting with matplotlib:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhonew</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">o</span><span class="o">.</span><span class="n">cartesian</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">log10</span><span class="p">(</span><span class="n">rhonew</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.cartesian">
<span class="sig-name descname"><span class="pre">cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myvar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.cartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cartesian coordinates.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>k: 3D slice (if applicable)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.cartesian_sasha">
<span class="sig-name descname"><span class="pre">cartesian_sasha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yourvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mirrorx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mirrory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.cartesian_sasha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.cartesian_sasha" title="Permalink to this definition">¶</a></dt>
<dd><p>This was adapted from <cite>plc</cite> at <cite>harm_script.py</cite>, atchekho/harmpi.
Need to understand this better.</p>
<ul class="simple">
<li><p>k: 3D slice (if applicable)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.data_assign">
<span class="sig-name descname"><span class="pre">data_assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.data_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.data_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.dump_assign">
<span class="sig-name descname"><span class="pre">dump_assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gd</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.dump_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.dump_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.fdump_assign">
<span class="sig-name descname"><span class="pre">fdump_assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gd</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.fdump_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.fdump_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.gdump2_assign">
<span class="sig-name descname"><span class="pre">gdump2_assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gd</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.gdump2_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.gdump2_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.gdump_assign">
<span class="sig-name descname"><span class="pre">gdump_assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gd</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.gdump_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.gdump_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.rdump_assign">
<span class="sig-name descname"><span class="pre">rdump_assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gd</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.rdump_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.rdump_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.read_body">
<span class="sig-name descname"><span class="pre">read_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noround</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.read_body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.read_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.read_file">
<span class="sig-name descname"><span class="pre">read_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saverdump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noround</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.read_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level function that reads either MPI or serial gdump’s</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Harm.read_header">
<span class="sig-name descname"><span class="pre">read_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issilent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnheaderline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Harm.read_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Harm.read_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the header for the dump file</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">Raishin</span></span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that reads a RAISHIN VTK datafile and converts to numpy format.</p>
<p>Attributes of the object:</p>
<ul class="simple">
<li><p>x,y,z: 1D position arrays for the mesh</p></li>
<li><p>rho: 1D density array</p></li>
<li><p>vx,vy,vz: 1D velocity arrays</p></li>
<li><p>p: 1D pressure</p></li>
<li><p>bx,by,bz: 1D magnetic field arrays</p></li>
<li><p>b2: 1D B^2</p></li>
</ul>
<p>Define an empty object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">grmhd</span><span class="o">.</span><span class="n">Raishin</span><span class="p">()</span>
</pre></div>
</div>
<p>Reads data from a VTK file, new attributes rho, p, vx, bx etc:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">vtk</span><span class="p">(</span><span class="s2">&quot;ok200.vtk&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Saves data as an ASCII file with columns corresponding to variables:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">&quot;ok200.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.regrid">
<span class="sig-name descname"><span class="pre">regrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.regrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Regrid one specific RAISHIN array to a nice cartesian grid for 
plotting with python. Note that RAISHIN’s output is already in
cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> – array to be regridded e.g. d.rho</p></li>
<li><p><strong>nboost</strong> – factor of increase of number of grid points compared to 
previous grid</p></li>
</ul>
</dd>
</dl>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">grmhd</span><span class="o">.</span><span class="n">Raishin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">vtk</span><span class="p">(</span><span class="s1">&#39;ok100.vtk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
</pre></div>
</div>
<p>TODO:
- 3D version
- parallel version</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.regridAll">
<span class="sig-name descname"><span class="pre">regridAll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.regridAll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.regridAll" title="Permalink to this definition">¶</a></dt>
<dd><p>Regrid all RAISHIN data to a nice cartesian grid for plotting with
python.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nboost</strong> – factor of increase of number of grid points compared to 
previous grid</p>
</dd>
</dl>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">grmhd</span><span class="o">.</span><span class="n">Raishin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">vtk</span><span class="p">(</span><span class="s1">&#39;ok100.vtk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">regridAll</span><span class="p">()</span>
</pre></div>
</div>
<p>Gets interpolated rho:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">xc</span><span class="p">)</span>
</pre></div>
</div>
<p>TODO:
- 3D version
- parallel version</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.regridsome">
<span class="sig-name descname"><span class="pre">regridsome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">listarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.regridsome"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.regridsome" title="Permalink to this definition">¶</a></dt>
<dd><p>Regrid the selected arrays in the RAISHIN data to a nice cartesian 
grid for plotting with python. Regridding only some of the arrays
will, of course, speed up things.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>listarr</strong> – list of strings specifying the arrays to be regridded.
Options are: rho, p, v, b</p></li>
<li><p><strong>nboost</strong> – factor of increase of number of grid points compared to 
previous grid</p></li>
</ul>
</dd>
</dl>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">grmhd</span><span class="o">.</span><span class="n">Raishin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">vtk</span><span class="p">(</span><span class="s1">&#39;ok100.vtk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">regridsome</span><span class="p">([</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>TODO:
- 3D version
- parallel version</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.savehdf5">
<span class="sig-name descname"><span class="pre">savehdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.savehdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.savehdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports data as compressed HDF5. 7x less space than ASCII.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.savenumpy">
<span class="sig-name descname"><span class="pre">savenumpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.savenumpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.savenumpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data as binary Numpy file .npz. 3x less space than ASCII.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.savetxt">
<span class="sig-name descname"><span class="pre">savetxt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.savetxt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.savetxt" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves data as ASCII file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.vtk">
<span class="sig-name descname"><span class="pre">vtk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vtkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.vtk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.vtk" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a VTK file created with the RAISHIN GRMHD code, this reads the
data as numpy arrays.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.grmhd.Raishin.yt2d">
<span class="sig-name descname"><span class="pre">yt2d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#Raishin.yt2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.Raishin.yt2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts 2d arrays from raishin to the 3d format that is understood
by the yt package. Make sure you used regridAll first.</p>
<p>Inspired by this example: <a class="reference external" href="http://stackoverflow.com/questions/7372316/how-to-make-a-2d-numpy-array-a-3d-array">http://stackoverflow.com/questions/7372316/how-to-make-a-2d-numpy-array-a-3d-array</a></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.grmhd.fixminus">
<span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">fixminus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#fixminus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.fixminus" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace nonphysical, negative values in array <em>x</em> with the corresponding
positive numerical values. Returns modified array. Does not 
touch original array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.grmhd.mdot">
<span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">mdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#mdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.mdot" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a contraction of two tensors/vectors.  Assumes
the following structure: tensor[m,n,i,j,k] OR vector[m,i,j,k], 
where i,j,k are spatial indices and m,n are variable indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.grmhd.myfloat">
<span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">myfloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#myfloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.myfloat" title="Permalink to this definition">¶</a></dt>
<dd><p>acc=1 means np.float32, acc=2 means np.float64</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.grmhd.regridFast">
<span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">regridFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#regridFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.regridFast" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a mesh in arbitrary coordinates (e.g. nonuniform elements)
into a uniform grid in the same coordinates. Uses a C function to 
speed things up.</p>
<p>One has to be particularly careful below about using a polar angle
(-pi/2&lt;theta&lt;pi/2) vs a spherical polar angle (0&lt;theta_sph&lt;pi). The
choice can affect some specific transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – New number of elements n^2. If None, figures out by itself</p></li>
<li><p><strong>xlim</strong> – Boundary for the plot and the grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.grmhd.wolframplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.grmhd.</span></span><span class="sig-name descname"><span class="pre">wolframplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">script</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/work/software/mathematica/raishin.wl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/grmhd.html#wolframplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.grmhd.wolframplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a pretty plot of density field and B vector field of RAISHIN
data using the Wolfram Language.</p>
<p>Make sure you point to the appropriate Wolfram script.</p>
<ul class="simple">
<li><p>infile: input RAISHIN ASCII file generated with Raishin.vtk above, e.g. ok200.dat</p></li>
<li><p>outfile: format that will produced, e.g. ok200.png</p></li>
</ul>
</dd></dl>

</section>
</section>
<section id="module-nmmn.lsd">
<span id="nmmn-lsd-module"></span><h2>nmmn.lsd module<a class="headerlink" href="#module-nmmn.lsd" title="Permalink to this headline">¶</a></h2>
<section id="lsd-operations-lists-sets-dictionaries-and-arrays">
<h3>LSD operations = lists, sets, dictionaries (and arrays)<a class="headerlink" href="#lsd-operations-lists-sets-dictionaries-and-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.arrAvg">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">arrAvg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#arrAvg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.arrAvg" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of 1D or 2D arrays, this method computes their average, 
returning an array with the same shape as the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alist</strong> – list of arrays</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average, std. dev. – arrays with the same shape as the input arrays</p>
</dd>
</dl>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="o">=</span><span class="n">arrAvg</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.bootstrap">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#bootstrap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs Monte Carlo simulated data set using the
Bootstrap algorithm.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bootstrap</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>where x is either an array or a list of arrays. If it is a
list, the code returns the corresponding list of bootstrapped 
arrays assuming that the same position in these arrays map the 
same “physical” object.</p>
<p>Rodrigo Nemmen, <a class="reference external" href="http://goo.gl/8S1Oo">http://goo.gl/8S1Oo</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.cmset_and">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">cmset_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#cmset_and"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.cmset_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cmset_and</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>returns the index of the elements of array x which are also present in the
array y.</p>
<p>This is equivalent to using the IDL command</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">botha</span><span class="o">=</span><span class="n">cmset_op</span><span class="p">(</span><span class="n">namea</span><span class="p">,</span> <span class="s1">&#39;AND&#39;</span><span class="p">,</span> <span class="n">nameb</span><span class="p">,</span> <span class="o">/</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
<p>i.e. performs the same thing as the IDL routine <a class="reference external" href="http://cow.physics.wisc.edu/~craigm/idl/idl.html">cmset_op</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.cmset_not">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">cmset_not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#cmset_not"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.cmset_not" title="Permalink to this definition">¶</a></dt>
<dd><p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cmset_not</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>returning the index of the elements of array x which are not present in the
array y.</p>
<p>This is equivalent to using the IDL command
SET = CMSET_OP(A, ‘AND’, /NOT2, B, /INDEX)   ; A but not B
i.e. performs the same thing as the IDL routine cmset_op from
<a class="reference external" href="http://cow.physics.wisc.edu/~craigm/idl/idl.html">http://cow.physics.wisc.edu/~craigm/idl/idl.html</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.cmsetsort_and">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">cmsetsort_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#cmsetsort_and"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.cmsetsort_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cmsetsort_and</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>returning the index of the elements of array x which are also present in the
array y.</p>
<p>The resulting elements have the same order as the ones in y. For 
instance, if you run</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">=</span><span class="n">cmsetsort_and</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">y</span>
</pre></div>
</div>
<p>will return an array of True, whereas if you used instead cmset_and it is
not guaranteed that all elements would match in x[i] and y.</p>
<p>Inherited from <code class="xref py py-func docutils literal notranslate"><span class="pre">nemmen.cmset_and()</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.crop">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops the image or 2D array, leaving only pixels inside the region
you define.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Znew</span><span class="p">,</span><span class="n">Xnew</span><span class="p">,</span><span class="n">Ynew</span> <span class="o">=</span> <span class="n">crop</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>where X,Y are 1D or 2D arrays, and Z is a 2D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> – 2d array</p></li>
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> – 1d or 2d arrays. In the latter case, they should have the same shape as z</p></li>
<li><p><strong>all</strong> – should I return cropped Z,X,Y or only Z?</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Z_cropped, X_cropped, Y_cropped</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.delnan">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">delnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#delnan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.delnan" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove nan elements from the array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.delweird">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">delweird</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#delweird"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.delweird" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove nan or inf elements from the array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.findnan">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">findnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#findnan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.findnan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return index of nan elements in the array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.nanzero">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">nanzero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#nanzero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.nanzero" title="Permalink to this definition">¶</a></dt>
<dd><p>Set nan elements to zero in the array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.norm">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes x1. If also given as input x2, then normalizes x1 to x2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – input array</p></li>
<li><p><strong>x2</strong> – optional</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized x1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.regrid">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">regrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ynew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#regrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Regrid 1D arrays (x,y,z) – where z is some scalar field mapped at positions
x,y – to a 2d array Z defined in the cartesian grids xnew,ynew (1D arrays with 
new grid).</p>
<p>For the interpolation method, choose nearest, linear or cubic.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span><span class="o">=</span><span class="n">regrid</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span><span class="n">xnew</span><span class="p">,</span><span class="n">ynew</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>need to create a 3d version of this method, paving the road for the 3d simulations.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.replacevals">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">replacevals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#replacevals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.replacevals" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace all values in array x for which abs(x)&lt;=minval with x=sign(x)*minval.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.search">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for the element in an array x with the value nearest xref.
Piece of code based on <a class="reference external" href="http://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array">http://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">=</span><span class="n">search</span><span class="p">(</span><span class="n">xref</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> – input number, array or list of reference values</p></li>
<li><p><strong>x</strong> – input array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index of the x-elements with values nearest to xref:</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.sortindex">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">sortindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#sortindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.sortindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of indexes, ordered according to the numerical value of each 
element of x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – input array or list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of element indexes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.string2float">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">string2float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#string2float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.string2float" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from an array of strings to floats.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">string2float</span><span class="p">(</span><span class="s1">&#39;28122014&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>returns 28122014.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> – a string or list/array of strings</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.lsd.uarray">
<span class="sig-prename descclassname"><span class="pre">nmmn.lsd.</span></span><span class="sig-name descname"><span class="pre">uarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/lsd.html#uarray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.lsd.uarray" title="Permalink to this definition">¶</a></dt>
<dd><p>With the new releases of the uncertainties and astropy.io.ascii (0.2.3, the
replacement of asciitable), if I try to create an uncertainties array with
the column of a table imported with ascii I run into trouble. For instance, 
if I use the sequence of commands below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.io.ascii</span> <span class="k">as</span> <span class="nn">asciitable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raff</span><span class="o">=</span> <span class="n">asciitable</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data/rafferty06.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span><span class="n">errm</span><span class="o">=</span><span class="n">raff</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span><span class="n">raff</span><span class="p">[</span><span class="s1">&#39;errm&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mass</span><span class="o">=</span><span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">errm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="n">mass</span>
</pre></div>
</div>
<p>I get the error message:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">*</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Column&#39;</span>
</pre></div>
</div>
<p>which I can only assume is due to the new way ascii handles tables.</p>
<p>I created this method to use as a replacement for unumpy.uarray that handles
the tables created with astropy.io.ascii.</p>
<p>Usage is the same as uncertainties.unumpy.uarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>uncertainties array.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-nmmn.misc">
<span id="nmmn-misc-module"></span><h2>nmmn.misc module<a class="headerlink" href="#module-nmmn.misc" title="Permalink to this headline">¶</a></h2>
<section id="miscelaneous-methods">
<h3>Miscelaneous methods<a class="headerlink" href="#miscelaneous-methods" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.adjustmodel">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">adjustmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#adjustmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.adjustmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Auxiliary method to read and normalize the BHBH simulation TS from Gold+14 
to the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tmod</span><span class="p">,</span><span class="n">smod</span><span class="o">=</span><span class="n">adjustmodel</span><span class="p">(</span><span class="s1">&#39;/Users/nemmen/work/projects/fermi/ngc1275/Gold paper/1,2nc mdot bin.csv&#39;</span><span class="p">,</span><span class="mf">5.6</span><span class="p">,</span><span class="mf">2008.6</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>obs is the data you want to normalize the model to.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>time in years, time in code units, signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.cart2pol">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">cart2pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#cart2pol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.cart2pol" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from cartesian to polar coordinates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">cart2pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.cart2sph">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">cart2sph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#cart2sph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.cart2sph" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from cartesian to spherical polar coordinates,
poles are at theta=0, equator at theta=90deg</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">cart2pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.convertyear">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">convertyear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#convertyear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.convertyear" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from decimal year to a python datetime tuple.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convertyear</span><span class="p">(</span><span class="mf">2012.9</span><span class="p">)</span>
</pre></div>
</div>
<p>returns datetime.datetime(2012, 11, 24, 12, 0, 0, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> – a float or array of floats</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a datetime structure (or list) with the date corresponding to the input float or array</p>
</dd>
</dl>
<p>Reference: <a class="reference external" href="http://stackoverflow.com/questions/19305991/convert-fractional-years-to-a-real-date-in-python">http://stackoverflow.com/questions/19305991/convert-fractional-years-to-a-real-date-in-python</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.date2dec">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">date2dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#date2dec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.date2dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a python datetime tuple to decimal year.</p>
<p>Inspired on <a class="reference external" href="http://stackoverflow.com/a/6451892/793218">http://stackoverflow.com/a/6451892/793218</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.evalfun">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">evalfun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#evalfun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.evalfun" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the function fun at each element of the array x, for the parameters
provided in the array/list par. fun is assumed to return a scalar. Returns an
array with fun evaluated at x. See example below.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<blockquote>
<div><p>x=1, par0=2, par1=3</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fun</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>returns a scalar</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evalfun</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">x</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<blockquote>
<div><p>evaluates fun at the array x and returns an array.</p>
</div></blockquote>
<p>v1 Dec. 2011</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.findPATH">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">findPATH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envVar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PYTHONPATH'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#findPATH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.findPATH" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a PATH or PYTHONPATH environment variable, find the full path of a file 
among different options. From <a class="reference external" href="https://stackoverflow.com/a/1124851/793218">https://stackoverflow.com/a/1124851/793218</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – file for which full path is desired</p></li>
<li><p><strong>envVar</strong> – environment variable with path to be searched</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>string with full path to file</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fullpath</span><span class="o">=</span><span class="n">findPATH</span><span class="p">(</span><span class="s2">&quot;fastregrid.cl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.lin2log">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">lin2log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dyl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#lin2log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.lin2log" title="Permalink to this definition">¶</a></dt>
<dd><p>From a given uncertainty in linear space and the value of y, calculates the
error in log space.</p>
<p>Returns a sequence with the lower and upper arrays with errors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.log2lin">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">log2lin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dlogyl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlogyu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#log2lin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.log2lin" title="Permalink to this definition">¶</a></dt>
<dd><p>From a given uncertainty in log-space (dex) and the value of y, calculates the
error in linear space.</p>
<p>Returns a sequence with the lower and upper arrays with errors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.mario">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">mario</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#mario"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.mario" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a nice Super Mario. :)</p>
<p>Analogous to mario in LaTeX.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.mathcontour">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">mathcontour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#mathcontour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.mathcontour" title="Permalink to this definition">¶</a></dt>
<dd><p>Suppose I want to draw the error ellipses for two parameters ‘x’ and ‘y’ 
with 1 s.d. uncertainties and the covariance between these uncertainties. 
I have a mathematica notebook that does that: ‘chisq contour plot.nb’.</p>
<p>This method takes the values ‘x,y,errx,erry,cov’ and outputs Mathematica
code that I can just copy and paste in the appropriate notebook in order 
to draw the ellipses.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.paperimpact">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">paperimpact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">citations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impactfactor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#paperimpact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.paperimpact" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a journal <cite>impactfactor</cite> and a given time interval <cite>dt</cite>, this
computes the expected number of citations for a given paper 
published in that journal over <cite>dt</cite>. It then gives the ratio of your
paper’s citation over the predicted value, to give you an idea
whether your paper is above or below average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>citations</strong> – number of citations for your paper</p></li>
<li><p><strong>dt</strong> – time since your paper was published in years</p></li>
<li><p><strong>impactfactor</strong> – impact factor for the journal where the paper was published</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.pol2cart">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">pol2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#pol2cart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.pol2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from polar to cartesian coordinates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">pol2cart</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.readmodel">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">readmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#readmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.readmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Auxiliary method to rescale the BHBH simulation time series from Gold+14 and 
compare with the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tphys12</span><span class="p">,</span> <span class="n">t12</span><span class="p">,</span> <span class="n">y12</span> <span class="o">=</span> <span class="n">readmodel</span><span class="p">(</span><span class="s1">&#39;Gold paper/1,2nc mdot bin.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>time in years, time in code units, signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.runsave">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">runsave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#runsave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.runsave" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes command cmd and saves its standard output as log</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.savepartial">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">savepartial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obsx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obsy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obsz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#savepartial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.savepartial" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports data file for partial correlation analysis with cens_tau.f.
cens_tau.f quantifies the correlation between X and Y eliminating the
effect of a third variable Z. I patched the Fortran code available from
<a class="reference external" href="http://astrostatistics.psu.edu/statcodes/sc_regression.html">http://astrostatistics.psu.edu/statcodes/sc_regression.html</a>.</p>
<p>Method arguments:
x,y,z = arrays with data for partial correlation
obs? = arrays of integers. 1 if there is a genuine measurement
available and 0 if there is only an upper limit i.e. censored data.</p>
<p>In the case of this study, X=Pjet, Y=Lgamma, Z=distance.</p>
<dl class="simple">
<dt>The structure of the resulting datafile is:</dt><dd><p>logPjet detected? logLgamma detected? logDist detected?</p>
</dd>
</dl>
<p>where the distance is in Mpc.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">agngrb</span><span class="o">.</span><span class="n">exportpartial</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">,</span><span class="nb">all</span><span class="o">.</span><span class="n">lg</span><span class="p">,</span><span class="n">log10</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">d</span><span class="p">),</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">),</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">),</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">),</span><span class="s1">&#39;par</span>
<span class="go">tialdata.dat&#39;)</span>
</pre></div>
</div>
<p>v1 Sep. 2011</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.scinotation">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">scinotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#scinotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.scinotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a number in scientific notation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – number</p></li>
<li><p><strong>n</strong> – number of significant digits to display</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.sph2cart">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">sph2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#sph2cart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.sph2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from spherical polar to cartesian coordinates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">pol2cart</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.string2year">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">string2year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#string2year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.string2year" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from a string in the format DDMMYYYY to a python datetime tuple.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">string2year</span><span class="p">(</span><span class="s1">&#39;28122014&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>returns datetime.datetime(2014, 12, 22, 0, 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> – a string or list of strings</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a datetime structure (or list) with the date corresponding to the input float or array</p>
</dd>
</dl>
<p>Reference: <a class="reference external" href="https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior">https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.vel_c2p">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">vel_c2p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#vel_c2p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.vel_c2p" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the polar components of a velocity vector which
is expressed in cartesian coordinates.</p>
<p>Returns: vr, vth</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.vel_p2c">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">vel_p2c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#vel_p2c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.vel_p2c" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cartesian components of a velocity vector which
is expressed in polar coordinates. i.e. apply a change of 
basis. See for example discussion after eq. 4 in 
<a class="reference external" href="https://ocw.mit.edu/courses/aeronautics-and-astronautics/16-07-dynamics-fall-2009/lecture-notes/MIT16_07F09_Lec05.pdf">https://ocw.mit.edu/courses/aeronautics-and-astronautics/16-07-dynamics-fall-2009/lecture-notes/MIT16_07F09_Lec05.pdf</a></p>
<p>Returns: vx, vy</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.misc.whichbces">
<span class="sig-prename descclassname"><span class="pre">nmmn.misc.</span></span><span class="sig-name descname"><span class="pre">whichbces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/misc.html#whichbces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.misc.whichbces" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the ‘bces’ string selector, returns an integer which tells the 
location of the BCES fitting results in the arrays returned by
the bces* methods.</p>
</dd></dl>

</section>
</section>
<section id="module-nmmn.plots">
<span id="nmmn-plots-module"></span><h2>nmmn.plots module<a class="headerlink" href="#module-nmmn.plots" title="Permalink to this headline">¶</a></h2>
<section id="fancy-plots">
<h3>Fancy plots<a class="headerlink" href="#fancy-plots" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.fitconf">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">fitconf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcesMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ort'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.683</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#fitconf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.fitconf" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper that given the input data performs the BCES
fit, get the orthogonal parameters and plot the best-fit line and
confidence band (generated using analytical methods). I decided to put together 
these commands in a method because I have been using them very frequently.</p>
<p>Assumes you initialized the plot window before calling this method.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">erra1</span><span class="p">,</span><span class="n">errb1</span><span class="p">,</span><span class="n">cov1</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">fitconf</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">errx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">erry</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">covxy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nboot</span><span class="p">,</span><span class="n">bces</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">confcolor</span><span class="o">=</span><span class="s1">&#39;LightGrey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Explanation of some arguments:</p>
<ul class="simple">
<li><p>xplot: if provided, will compute the confidence band in the X-values provided</p></li>
</ul>
<p>with xplot
- front: if True, then will plot the confidence band in front of the data
points; otherwise, will plot it behind the points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.fitconfmc">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">fitconfmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcesMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ort'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#fitconfmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.fitconfmc" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper that given the input data performs the BCES
fit, get the orthogonal parameters and plot the best-fit line and
confidence band (generated using MC). I decided to put together these 
commands in a method because I have been using them very frequently.</p>
<p>Assumes you initialized the plot window before calling this method.
This method is more stable than fitconf, which is plagued with numerical 
instabilities when computing the gradient.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">erra1</span><span class="p">,</span><span class="n">errb1</span><span class="p">,</span><span class="n">cov1</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">fitconf</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">errx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">erry</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">covxy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nboot</span><span class="p">,</span><span class="n">bces</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">confcolor</span><span class="o">=</span><span class="s1">&#39;LightGrey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Explanation of some arguments:
- xplot: if provided, will compute the confidence band in the X-values provided
with xplot
- front: if True, then will plot the confidence band in front of the data
points; otherwise, will plot it behind the points
- conf: size of confidence band to be plotted in standard deviations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.fitconfpred">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">fitconfpred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ort'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.68</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LightGrey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Khaki'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#fitconfpred"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.fitconfpred" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper that given the input data performs the BCES
fit, get the orthogonal parameters and plot (i) the best-fit line,
(ii) confidence band and (iii) prediction band.</p>
<p>I decided to put together these commands in a method because I have been 
using them very frequently.</p>
<p>Assumes you initialized the plot window before calling this method.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">erra1</span><span class="p">,</span><span class="n">errb1</span><span class="p">,</span><span class="n">cov1</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">fitconfpred</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">errx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">erry</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">covxy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nboot</span><span class="p">,</span><span class="n">bces</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">confcolor</span><span class="o">=</span><span class="s1">&#39;LightGrey&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.fitpred">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">fitpred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ort'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.68</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Khaki'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#fitpred"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.fitpred" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper that given the input data performs the BCES
fit, get the orthogonal parameters and plot (i) the best-fit line and
(ii) prediction band.</p>
<p>I decided to put together these commands in a method because I have been 
using them very frequently.</p>
<p>Assumes you initialized the plot window before calling this method.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">erra1</span><span class="p">,</span><span class="n">errb1</span><span class="p">,</span><span class="n">cov1</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">fitpred</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">errx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">erry</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">covxy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nboot</span><span class="p">,</span><span class="n">bces</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">predcolor</span><span class="o">=</span><span class="s1">&#39;LightGrey&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.fourcumplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">fourcumplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_1$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_2$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_3$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x4leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_3$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&quot;$N(x&gt;x')$&quot;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#fourcumplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.fourcumplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Script that plots the cumulative histograms of four variables x1, x2, x3 and x4
sharing the same X-axis. For each bin, Y is the fraction of the sample 
with values above X.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>x1,x2,x3,x4: arrays with data to be plotted</p></li>
<li><p>xmin,xmax: lower and upper range of plotted values, will be used to set a consistent x-range</p></li>
</ul>
<p>for both histograms.
- x1leg, x2leg, x3leg, x4leg: legends for each histogram        
- xlabel: self-explanatory.
- sharey: sharing the Y-axis among the histograms?
- bins1,bins2,…: number of bins in each histogram
- fig: which plot window should I use?</p>
<p>Inspired by <a class="reference external" href="http://www.scipy.org/Cookbook/Matplotlib/Multiple_Subplots_with_One_Axis_Label">Scipy</a>.</p>
<p>v1 Jun. 2012: inherited from fourhists.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.fourhists">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">fourhists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_1$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_2$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_3$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x4leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_3$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line1b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line2b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line3b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line4b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#fourhists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.fourhists" title="Permalink to this definition">¶</a></dt>
<dd><p>Script that plots four histograms of quantities x1, x2, x3 and x4
sharing the same X-axis.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>x1,x2,x3,x4: arrays with data to be plotted</p></li>
<li><p>xmin,xmax: lower and upper range of plotted values, will be used to set a consistent x-range</p></li>
</ul>
<p>or both histograms.
- x1leg, x2leg, x3leg, x4leg: legends for each histogram        
- xlabel: self-explanatory.
- sharey: sharing the Y-axis among the histograms?
- bins1,bins2,…: number of bins in each histogram
- fig: which plot window should I use?
- line?: draws vertical solid lines at the positions indicated in each panel
- line?b: draws vertical dashed lines at the positions indicated in each panel</p>
<figure class="align-default" id="id11">
<a class="reference internal image-reference" href="_images/fourhists.png"><img alt="Four histograms in the same figure" src="_images/fourhists.png" style="width: 1226.0px; height: 926.0px;" /></a>
<figcaption>
<p><span class="caption-text">Four histograms in the same figure.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Inspired by <a class="reference external" href="http://www.scipy.org/Cookbook/Matplotlib/Multiple_Subplots_with_One_Axis_Label">Scipy</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.image">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ynew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates pretty image. You need to specify:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.ipyplots">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">ipyplots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#ipyplots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.ipyplots" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes sure we have exactly the same matplotlib settings as in the IPython terminal 
version. Call this from IPython notebook.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16905028/why-is-matplotlib-plot-produced-from-ipython-notebook-slightly-different-from-te)">Source</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.jh">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">jh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ort'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.683</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#jh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.jh" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper that given the input data performs the BCES
fit, get the orthogonal parameters, best-fit line and
confidence band. Then returns the points corresponding to the line and
confidence band.</p>
<p>I wrote this for the John Hunter plotting contest, in order to simplify
my AGN-GRB plot. Inherited from method fitconf.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">lcb</span><span class="p">,</span><span class="n">ucb</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">fitconf</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">errx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">erry</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">covxy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nboot</span><span class="p">,</span><span class="n">bces</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">confcolor</span><span class="o">=</span><span class="s1">&#39;LightGrey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where y are the line points, lcb and ucb are the lower and upper confidence band
points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xplot</strong> – if provided, will compute the confidence band in the X-values provided
with xplot</p></li>
<li><p><strong>front</strong> – if True, then will plot the confidence band in front of the data
points; otherwise, will plot it behind the points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.jointplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">jointplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#jointplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.jointplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the joint distribution of posteriors for X1 and X2, including the 1D
histograms showing the median and standard deviations.</p>
<p>The work that went in creating this nice method is shown, step by step, in 
the ipython notebook “error contours.ipynb”. Sources of inspiration:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://python4mpia.github.io/intro/quick-tour.html">http://python4mpia.github.io/intro/quick-tour.html</a></p></li>
<li><p><a class="reference external" href="http://stackoverflow.com/questions/12301071/multidimensional-confidence-intervals">http://stackoverflow.com/questions/12301071/multidimensional-confidence-intervals</a></p></li>
</ul>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jointplot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">rtr</span><span class="o">.</span><span class="n">trace</span><span class="p">(),</span><span class="n">M</span><span class="o">.</span><span class="n">mdot</span><span class="o">.</span><span class="n">trace</span><span class="p">(),</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$\log \ r_{</span><span class="se">\r</span><span class="s1">m tr}$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$\log \ \dot</span><span class="si">{m}</span><span class="s1">$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>gives the following plot.</p>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="_images/jointplot.png"><img alt="Two-dimensional kernel density distribution." src="_images/jointplot.png" style="width: 828.0px; height: 556.0px;" /></a>
<figcaption>
<p><span class="caption-text">Two-dimensional kernel density distribution, along with one-dimensional histograms of each distribution.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.make_cmap">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">make_cmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#make_cmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.make_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>make_cmap takes a list of tuples which contain RGB values. The RGB
values may either be in 8-bit [0 to 255] (in which bit must be set to
True when called) or arithmetic [0 to 1] (default). make_cmap returns
a cmap with equally spaced colors.
Arrange your tuples so that the first color is the lowest value for the
colorbar and the last is the highest.
position contains values from 0 to 1 to dictate the location of each color.</p>
<p>source: <a class="reference external" href="http://schubert.atmos.colostate.edu/~cslocum/custom_cmap.html">http://schubert.atmos.colostate.edu/~cslocum/custom_cmap.html</a>
Chris Slocum, Colorado State University</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.onehist">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">onehist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#onehist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.onehist" title="Permalink to this definition">¶</a></dt>
<dd><p>Script that plots the histogram of x with the corresponding xlabel.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.parulacmap">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">parulacmap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#parulacmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.parulacmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the beautiful Parula colormap which is Matlab’s default.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mycmap</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">parulacmap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mycmap</span><span class="p">)</span>
</pre></div>
</div>
<p>Code taken from <a class="reference external" href="https://github.com/BIDS/colormap/blob/master/parula.py">here</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.plot">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the plot of a grmonty spectrum as a pyplot object or plot it on 
the screen</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param</strong> – grmonty spectrum file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.plotlinfit">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">plotlinfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.683</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#plotlinfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.plotlinfit" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper that given the output data from a linear regression
method (for example, bayeslin.pro, the Bayesian linear regression method 
of Kelly (2007)), it plots the fits and the confidence bands.
The input is:
X, Y, slope (A), errA, intercept (B), errB and cov(A,B)</p>
<p>Assumes you initialized the plot window before calling this method.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nemmen</span><span class="o">.</span><span class="n">plotlinfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">erra</span><span class="p">,</span><span class="n">errb</span><span class="p">,</span><span class="n">covab</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">confcolor</span><span class="o">=</span><span class="s1">&#39;LightGrey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Explanation of some arguments:
- xplot: if provided, will compute the confidence band in the X-values provided
with xplot
- front: if True, then will plot the confidence band in front of the data
points; otherwise, will plot it behind the points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.symlog">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">symlog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.43429448190325176</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#symlog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.symlog" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a modified logarithm function to x that handles negative 
values while maintaining continuity across 
zero. This function solves a very concrete problem: how to handle
data that spans a huge range and has also negative values? log10
will fail. This is the answer.</p>
<p>The transformation is defined in an article from the journal 
Measurement Science and Technology (Webber, 2012):</p>
<p>y = sign(x)*(log10(1+abs(x)/(10^C)))</p>
<p>where the scaling constant C determines the resolution of the data 
around zero. The smallest order of magnitude shown on either side of 
zero will be 10^ceil(C).</p>
<p>Reference: MATHWORKS symlog &lt;<a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/57902-symlog">https://www.mathworks.com/matlabcentral/fileexchange/57902-symlog</a>&gt;</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.text">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.text" title="Permalink to this definition">¶</a></dt>
<dd><p>Version of pylab.text that can be applied to arrays.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">s</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>will plot the strings in array ‘s’ at coordinates given by arrays
‘x’ and ‘y’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.threehists">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">threehists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_1$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_2$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_3$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#threehists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.threehists" title="Permalink to this definition">¶</a></dt>
<dd><p>Script that plots three histograms of quantities x1, x2 and x3 
sharing the same X-axis.</p>
<p>Arguments:
- x1,x2,x3: arrays with data to be plotted
- xmin,xmax: lower and upper range of plotted values, will be used to set a consistent x-range for both histograms.
- x1leg, x2leg, x3leg: legends for each histogram       
- xlabel: self-explanatory.
- sharey: sharing the Y-axis among the histograms?
- fig: which plot window should I use?</p>
<p>Example:
x1=Lbol(AD), x2=Lbol(JD), x3=Lbol(EHF10)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">threehists</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="s1">&#39;AD&#39;</span><span class="p">,</span><span class="s1">&#39;JD&#39;</span><span class="p">,</span><span class="s1">&#39;EHF10&#39;</span><span class="p">,</span><span class="s1">&#39;$\log L_{</span><span class="se">\r</span><span class="s1">m bol}$ (erg s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Inspired by <a class="reference external" href="http://www.scipy.org/Cookbook/Matplotlib/Multiple_Subplots_with_One_Axis_Label">Scipy</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.threehistsx">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">threehistsx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_1$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_2$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_3$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#threehistsx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.threehistsx" title="Permalink to this definition">¶</a></dt>
<dd><p>Script that pretty-plots three histograms of quantities x1, x2 and x3.</p>
<p>Arguments:
:param x1,x2,x3: arrays with data to be plotted
:param x1leg, x2leg, x3leg: legends for each histogram  
:param fig: which plot window should I use?</p>
<p>Example:
x1=Lbol(AD), x2=Lbol(JD), x3=Lbol(EHF10)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">threehists</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="s1">&#39;AD&#39;</span><span class="p">,</span><span class="s1">&#39;JD&#39;</span><span class="p">,</span><span class="s1">&#39;EHF10&#39;</span><span class="p">,</span><span class="s1">&#39;$\log L_{</span><span class="se">\r</span><span class="s1">m bol}$ (erg s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Inspired by <a class="reference external" href="http://www.scipy.org/Cookbook/Matplotlib/Multiple_Subplots_with_One_Axis_Label">http://www.scipy.org/Cookbook/Matplotlib/Multiple_Subplots_with_One_Axis_Label</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.turbocmap">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">turbocmap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#turbocmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.turbocmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Turbo colormap: an improved version of the awful jet colormap.</p>
<p>The look-up table contains 256 entries. Each entry is a floating point sRGB triplet.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">turbo</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">turbocmap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">turbo</span><span class="p">)</span>
</pre></div>
</div>
<p>Copyright 2019 Google LLC.
SPDX-License-Identifier: Apache-2.0
Author: Anton Mikhailov</p>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gist.github.com/mikhailov-work/ee72ba4191942acecc03fe6da94fc73f">turbo colormap array</a></p></li>
<li><p>Google AI <a class="reference external" href="https://ai.googleblog.com/2019/08/turbo-improved-rainbow-colormap-for.html">blog post</a> describing the advantages of the colormap</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.twohists">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">twohists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_1$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x_2$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#twohists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.twohists" title="Permalink to this definition">¶</a></dt>
<dd><p>Script that plots two histograms of quantities x1 and x2
sharing the same X-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong><strong>,</strong><strong>x2</strong> – arrays with data to be plotted</p></li>
<li><p><strong>xmin</strong><strong>,</strong><strong>xmax</strong> – lower and upper range of plotted values, will be used to set a consistent x-range
for both histograms.</p></li>
<li><p><strong>x2leg</strong> (<em>x1leg</em><em>,</em>) – legends for each histogram</p></li>
<li><p><strong>xlabel</strong> – self-explanatory.</p></li>
<li><p><strong>bins1</strong><strong>,</strong><strong>bins2</strong> – number of bins in each histogram</p></li>
<li><p><strong>fig</strong> – which plot window should I use?</p></li>
<li><p><strong>range</strong> – in the form (xmin,xmax), same as range argument for hist and applied to both
histograms.</p></li>
</ul>
</dd>
</dl>
<p>Inspired by <a class="reference external" href="http://www.scipy.org/Cookbook/Matplotlib/Multiple_Subplots_with_One_Axis_Label">Scipy</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.uerrorbar">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">uerrorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uy</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#uerrorbar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.uerrorbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Adaptation of pylab.errorbar to work with arrays defined using the
uncertainties package, which include the errorbars built-in.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uerrorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will plot the points and error bars associated with the ‘unumpy’
arrays x and y</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.plots.wolframcmap">
<span class="sig-prename descclassname"><span class="pre">nmmn.plots.</span></span><span class="sig-name descname"><span class="pre">wolframcmap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/plots.html#wolframcmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.plots.wolframcmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns colormap that matches closely the one used by default
for images in Wolfram Mathematica 11 (dark blue to orange).</p>
<p>I spent one hour playing around to reproduce it.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mycmap</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">wolframcmap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mycmap</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id13">
<a class="reference internal image-reference" href="_images/wolframcmap.png"><img alt="Image plotted using Wolfram's colormap" src="_images/wolframcmap.png" style="width: 734.0px; height: 756.0px;" /></a>
<figcaption>
<p><span class="caption-text">Image plotted using Wolfram’s colormap.</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</dd></dl>

</section>
</section>
<section id="module-nmmn.sed">
<span id="nmmn-sed-module"></span><h2>nmmn.sed module<a class="headerlink" href="#module-nmmn.sed" title="Permalink to this headline">¶</a></h2>
<section id="spectral-energy-distributions">
<h3>Spectral energy distributions<a class="headerlink" href="#spectral-energy-distributions" title="Permalink to this headline">¶</a></h3>
<p>Methods and classes for dealing with spectral energy distributions (SEDs).</p>
<dl class="py class">
<dt class="sig sig-object py" id="nmmn.sed.SED">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">SED</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lognu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that defines objects storing Spectral energy distributions (SEDs). 
The SEDs can be imported either from datafiles with the observations/models,
or from arrays with the values of log(nu) and log(nuLnu).</p>
<p>The object’s initial attributes are:</p>
<ul class="simple">
<li><p>nu: frequency in Hertz</p></li>
<li><p>lognu: log10(frequency)</p></li>
<li><p>nlnu: nu L_nu in erg/s</p></li>
<li><p>ll: log10(nu Lnu)</p></li>
<li><p>file : input datafile</p></li>
</ul>
<p>To import a SED from an ASCII file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">sed</span><span class="o">.</span><span class="n">SED</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">datafile</span><span class="p">,</span> <span class="n">logfmt</span><span class="o">=</span><span class="n">XX</span><span class="p">)</span>
</pre></div>
</div>
<p>where logfmt is 1 if the data is already in logarithm or 0 otherwise.
NOTE: logfmt for now is by default 0 (Eracleous’ SEDs).</p>
<p>To create a SED object from the arrays lognu and lognulnu:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">sed</span><span class="o">.</span><span class="n">SED</span><span class="p">(</span><span class="n">lognu</span><span class="o">=</span><span class="n">lognu</span><span class="p">,</span> <span class="n">ll</span><span class="o">=</span><span class="n">lognulnu</span><span class="p">)</span>
</pre></div>
</div>
<p>To import a SED in a special format:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">sed</span><span class="o">.</span><span class="n">SED</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">erac</span><span class="p">(</span><span class="s1">&#39;ngc1097.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To plot the SED:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lognu</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">ll</span><span class="p">)</span>
</pre></div>
</div>
<p>To calculate the bolometric luminosity:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">bol</span><span class="p">()</span>
</pre></div>
</div>
<p>after which the value will be stored in s.lumbol</p>
<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.alphaox">
<span class="sig-name descname"><span class="pre">alphaox</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.alphaox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.alphaox" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the alpha_ox index.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">alphaox</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alphaox</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.bol">
<span class="sig-name descname"><span class="pre">bol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lognu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lognu1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[8,</span> <span class="pre">22]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.bol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.bol" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the bolometric luminosity of the SED. Performs the integration 
using the trapezoidal rule. Adds the attribute lumbol to the object with
the result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">bol</span><span class="p">()</span>
</pre></div>
</div>
<p>makes the variable s.lumbol hold the bolometric luminosity.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">bol</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>makes s.lumbol hold the luminosity integrated in the range 1e17-1e20 Hz.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">bol</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">lognu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="o">.</span><span class="n">lognu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p>gives the integrated luminosity in the range 1e18-1e20 Hz. Before integrating,
interpolates the SED over its original frequency range with 1000 points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether there are NaN or Inf values in the array log10(nuLnu).
If so, displays a warning to the user and the corresponding filename.
Method called by initialization methods init and erac.</p>
<p>Creates a new attribute, weird, which is 1 if there are NaN or Inf values,
and 0 otherwise.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.chisq">
<span class="sig-name descname"><span class="pre">chisq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.chisq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.chisq" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the goodness of fit between the observed SED (assumed to be “self”) 
and the given model. If you don’t provide the number of free 
parameters in the model, it returns a modified chi squared (modified in 
the sense that it assumes the uncertainties in all data points to be unity).
If you provide npars it returns the modified reduced chi squared.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">chisq</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">returns the (modified) chi square with s and m being the observed and model</span>
<span class="go">SEDs, respectively.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">chisq</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">returns the reduced chi square.</span>
</pre></div>
</div>
<p>NOTE: this method was written assuming that the observed SEDs correspond
to Eracleous’ SEDs. Needs to be adapted in order to be applied to other 
types of SEDs. We discard the 100 keV interpolation done by EHF10.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the current SED object. Use this in the same way you would use
the numpy copy() method to avoid changing the attributes of a SED
unintentionally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.edd">
<span class="sig-name descname"><span class="pre">edd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.edd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.edd" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Eddington ratio <span class="math notranslate nohighlight">\(L_{\rm bol}/L_{\rm} Edd}\)</span>.
First computes the bolometric luminosity via interpolation and 
then calculates the Eddington ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mass</strong> – log10(BH mass in solar masses)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.erac">
<span class="sig-name descname"><span class="pre">erac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.erac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.erac" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads SEDs in the format provided by Eracleous et al. LINER SEDs:
nu      nuLnu   nuLnu(extinction)       error   upperLimit?(0/1)</p>
<p>Adds the following attributes to the SED object:
- nlnuex: nuLnu after extinction correction
- llex: log10(nuLnu) after extinction correction
- ul: is the datapoint an upper limit (arrow)? 1 if yes, 0 if not</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.findlum">
<span class="sig-name descname"><span class="pre">findlum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.findlum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.findlum" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the input frequency in units of log(nu/Hz), returns the list [log(nu),
Lnu] with the frequency and luminosity closest to the specified value.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lognu</span><span class="p">,</span><span class="n">lum</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">findlum</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<p>will look for the freq. and lum. nearest nu=10^14 Hz</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.geomean">
<span class="sig-name descname"><span class="pre">geomean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17.684</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refnlnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e+40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.geomean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.geomean" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of SEDs and a reference value of log10(nu), normalizes the 
SEDs (s.normalize) at the given nuref and refnlnu, calculates the geometric
mean of their luminosities (average(log10(nuLnu)), like Eracleous et al. 2010 does) 
and returns the list [mean,sd] where ‘mean’ is SED object with the geometric 
mean and ‘sd’ is the object with the standard deviation.</p>
<p>Alternatively, if the user provides the argument xray=True, then
the method normalizes the SEDs such that they have the same X-ray
luminosity refnlnu in the range 2-10 keV (thus ignoring the arg.
nuref).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="mf">17.684</span><span class="p">,</span><span class="mf">1e40</span><span class="p">)</span>
</pre></div>
</div>
<p>returns mean &lt;- [lognu, &lt;s1,s2&gt;],
where &lt;s,s1,s2&gt; -&gt; &lt;log10[nuLnu(s),nuLnu(s1),nuLnu(s2)]&gt;, lognu being the common 
units of frequency for the SEDs after interpolation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="n">refnlnu</span><span class="o">=</span><span class="mf">1e40</span><span class="p">,</span><span class="n">xray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>returns the mean after normalizing the SEDs to the X-ray lum.
1e40 erg/s in the range 2-10 keV.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.grmonty">
<span class="sig-name descname"><span class="pre">grmonty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.grmonty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.grmonty" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads SEDs in the format provided by grmonty. I ported the 
original SM script <cite>plspec.m</cite> provided by J. Dolence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.hayden">
<span class="sig-name descname"><span class="pre">hayden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.hayden"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.hayden" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Reads SEDs in the format provided by Hampadarath et al.:</p>
</div></blockquote>
<p>nu(GHz) flux(microJy) error(microJy) Detection[1]orUpperlimit[0]</p>
<blockquote>
<div><p>Adds the following attributes to the SED object:
- ul: is the datapoint an upper limit (arrow)? 1 if yes, 0 if not
- distance: distance to object in Mpc</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.haydenx">
<span class="sig-name descname"><span class="pre">haydenx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.haydenx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.haydenx" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads X-ray data in the format provided by F. Panessa:
nu      error_nu nuLnu  error   ?</p>
<p>Adds the following attributes to the SED object:
- ul: is the datapoint an upper limit (arrow)? 1 if yes, 0 if not</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.interp">
<span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[8,</span> <span class="pre">22]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates the SED and a list of SEDs (optional) in the given range
of values of log(nu) and for the given number of points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">interp</span><span class="p">([</span><span class="n">s</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">])</span>
<span class="go">interpolates s, s1 and s2 with 1000 points in the range</span>
<span class="go">log(nu)=8-22 (Hz). s, s1 and s2 are also instances of the class SED. The</span>
<span class="go">interpolated arrays (lognui, lli, nui, nlnui) will be added as new </span>
<span class="go">attributes to each object. If given no argument, will interpolate the</span>
<span class="go">current SED object.</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seds</strong> – list of SED objects to interpolate</p></li>
<li><p><strong>points</strong> – number of interpolated points</p></li>
<li><p><strong>xrange</strong> – list in the form [xinitial, xfinal] with the x-range of interpolation.</p></li>
</ul>
</dd>
</dl>
<p>If provided with no list of SEDs (e.g., s.interp()), then the method
interpolates only the current SED s. If provided with no xrange argument,
it will by default assume the range [8,22] discarding data points outside
that range in the interpolation, hence adjust accordingly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.ion">
<span class="sig-name descname"><span class="pre">ion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.ion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the rate of ionizing photons in the SED.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17.684</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refnlnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e+40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of SEDs and a reference value of log10(nu), normalizes the 
SEDs (s.normalize) at the given nuref and refnlnu, calculates the average 
of their luminosities (average(log10(nuLnu)), like Eracleous et al. 2010 does) 
and returns the list [mean,sd] where ‘mean’ is SED object with the mean and 
‘sd’ is the object with the     standard deviation.</p>
<p>Alternatively, if the user provides the argument xray=True, then
the method normalizes the SEDs such that they have the same X-ray
luminosity refnlnu in the range 2-10 keV (thus ignoring the arg.
nuref).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="mf">17.684</span><span class="p">,</span><span class="mf">1e40</span><span class="p">)</span>
</pre></div>
</div>
<p>returns mean &lt;- [lognu, &lt;s1,s2&gt;],
where &lt;s,s1,s2&gt; -&gt; &lt;log10[nuLnu(s),nuLnu(s1),nuLnu(s2)]&gt;, lognu being the common 
units of frequency for the SEDs after interpolation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="n">refnlnu</span><span class="o">=</span><span class="mf">1e40</span><span class="p">,</span><span class="n">xray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>returns the mean after normalizing the SEDs to the X-ray lum.
1e40 erg/s in the range 2-10 keV.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.meanlin">
<span class="sig-name descname"><span class="pre">meanlin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17.684</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refnlnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e+40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.meanlin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.meanlin" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of SEDs and a reference value of log10(nu), normalizes the 
SEDs (s.normalize) at the given nuref and refnlnu, calculates the average 
of their luminosities (log10(average nuLnu)) and returns the list [mean,sd] 
where ‘mean’ is SED object with the mean and ‘sd’ is the object with the
standard deviation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">meanlin</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="mf">17.684</span><span class="p">,</span><span class="mf">1e40</span><span class="p">)</span>
<span class="go">returns mean &lt;- [lognu, &lt;s1,s2&gt;],</span>
<span class="go">where &lt;s,s1,s2&gt; -&gt; log10[&lt;nuLnu(s),nuLnu(s1),nuLnu(s2)&gt;], lognu being the common </span>
<span class="go">units of frequency for the SEDs after interpolation.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.median">
<span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17.684</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refnlnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e+40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.median" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of SEDs and a reference value of log10(nu), normalizes the 
SEDs (s.normalize) at the given nuref and refnlnu, calculates the average 
of their luminosities (average(log10(nuLnu)), like Eracleous et al. 2010 does) 
and returns the list [mean,sd] where ‘mean’ is SED object with the median and 
‘sd’ is the object with the     standard deviation.</p>
<p>Alternatively, if the user provides the argument xray=True, then
the method normalizes the SEDs such that they have the same X-ray
luminosity refnlnu in the range 2-10 keV (thus ignoring the arg.
nuref).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">median</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="mf">17.684</span><span class="p">,</span><span class="mf">1e40</span><span class="p">)</span>
</pre></div>
</div>
<p>returns median &lt;- [lognu, &lt;s1,s2&gt;],
where &lt;s,s1,s2&gt; -&gt; &lt;log10[nuLnu(s),nuLnu(s1),nuLnu(s2)]&gt;, lognu being the common 
units of frequency for the SEDs after interpolation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">means</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">median</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">],</span><span class="n">refnlnu</span><span class="o">=</span><span class="mf">1e40</span><span class="p">,</span><span class="n">xray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>returns the mean after normalizing the SEDs to the X-ray lum.
1e40 erg/s in the range 2-10 keV.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17.684</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refnlnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e+40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes a SED at the given frequency (lognu/Hz) and nuLnu (erg/s). 
NOTE: this will modify the SED(s). Alternatively, if the user provides 
the argument xray=True, then the method normalizes the SEDs such that 
they have the same X-ray luminosity refnlnu in the range 2-10 keV 
(thus ignoring the arg. nuref).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">normalize</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">])</span>
</pre></div>
</div>
<p>normalizes the SEDs in the object list at the same frequency and nuLnu</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">normalize</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">],</span><span class="n">refnlnu</span><span class="o">=</span><span class="mf">1e40</span><span class="p">,</span><span class="n">xray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>normalizes the SEDs such that they have the same X-ray luminosity 1e40 
erg/s in the range 2-10 keV.</p>
<p>The method is designed to automatically call the interp method (e.g., 
s.interp([s1,s2])) if needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.prieto">
<span class="sig-name descname"><span class="pre">prieto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.prieto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.prieto" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Reads SEDs in the format provided by Hampadarath et al.:</p>
</div></blockquote>
<p>nu(Hz) nu*F_nu(Jy Hz)</p>
<blockquote>
<div><p>Adds the following attributes to the SED object:
- distance: distance to object in Mpc</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.radioloud">
<span class="sig-name descname"><span class="pre">radioloud</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.radioloud"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.radioloud" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the radio-loudness for the SED. Adds the attribute rl to the 
object with     the result. If Ro&gt;=10. we have a RL AGN, otherwise it is a
RQ one.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rl</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">radioloud</span><span class="p">()</span>
</pre></div>
</div>
<p>makes the variable s.rl hold the radio-loudness.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.raniere">
<span class="sig-name descname"><span class="pre">raniere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.raniere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.raniere" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads SEDs in the format provided by Hampadarath et al.:
nu(GHz) flux(microJy) error(microJy) Detection[1]orUpperlimit[0]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> – file with SED data</p></li>
<li><p><strong>dist</strong> – distance in Mpc</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED object in units of Hz vs erg/s</p>
</dd>
</dl>
<p>Adds the following attributes to the SED object:
- ul: is the datapoint an upper limit (arrow)? 1 if yes, 0 if not
- distance: distance to object in Mpc</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.sort" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
<p>Sorts the SED in ascending order of frequencies.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.unit">
<span class="sig-name descname"><span class="pre">unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the spectrum to one.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports the SED as an ASCII file with the structure:
col1=log10(nu/Hz), col2=log10(nu Lnu / erg per sec)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
<p>exports the SED s as the file “file”</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmmn.sed.SED.xrays">
<span class="sig-name descname"><span class="pre">xrays</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#SED.xrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.SED.xrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the photon index of the X-ray spectrum and Lx (2-10 keV). 
Stores the new attributes gammax and lumx in the object.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Lx</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">xrays</span><span class="p">()</span>
</pre></div>
</div>
<p>creates the new attributes s.lumx and s.gammax</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.f">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xpop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the spectrum of a popstar and an array of frequencies ‘x’,
this outputs the values of ypop for each x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – frequencies</p></li>
<li><p><strong>xpop</strong><strong>,</strong><strong>ypop</strong> – spectrum from stellar population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>returns y=a*L where L is the stellar pop. luminosity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.groupmodel">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">groupmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#groupmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.groupmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Groups the different components of a SED model into one dictionary for convenient
access. The model component SEDs are assumed to have been imported using the
SED class. This method is used in the plot method.</p>
<p>Example:</p>
<p>Imports the model SEDs:
&gt;&gt;&gt; s=SED(file=’sum.dat’, logfmt=1)
&gt;&gt;&gt; disk=SED(file=’disk.dat’, logfmt=1)
&gt;&gt;&gt; a=SED(file=’adaf.dat’, logfmt=1)</p>
<p>Groups them together in a dictionary d:
&gt;&gt;&gt; d=groupmodel(sum=s,ssd=disk,adaf=a)
returning {‘sum’:s,’ssd’:disk,’adaf’:a}.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.haydenobs">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">haydenobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/work/projects/hayden/all/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/work/projects/hayden/info.dat'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#haydenobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.haydenobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the observed SED from the Hayden et al. sample. Includes arrows 
for upper limits and the nice bow tie.</p>
<p>Extinction corrections represented as either “error bars” or “circle + error bar”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – source name e.g. ‘NGC1097’ or ‘ngc1097’ or ‘NGC 1097’. Must have four numbers.</p></li>
<li><p><strong>patho</strong> – path to observed SED data files</p></li>
<li><p><strong>info</strong> – path to information datafile with distances and masses</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.haydensed">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">haydensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/work/projects/hayden/all/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/work/projects/hayden/info.dat'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#haydensed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.haydensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an observed SED from the Hayden et al. sample. Computes useful 
quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – source name e.g. ‘NGC1097’ or ‘ngc1097’ or ‘NGC 1097’. Must have four numbers.</p></li>
<li><p><strong>patho</strong> – path to observed SED data files</p></li>
<li><p><strong>info</strong> – path to information datafile with distances and masses</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.modelplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">modelplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ssdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jetf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sumf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#modelplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.modelplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the model components.</p>
<p>Arguments: The filenames of each model component.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.modelsplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">modelsplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/Dropbox/work/projects/adafjet/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jetfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showjet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showsum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showadaf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#modelsplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.modelsplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Nice wrapper that plots 3 models computed with the ADAF Fortran code available at
~/work/projects/adafjet/adaf.</p>
<p>Useful when modeling a given SED.</p>
<dl class="simple">
<dt>Input:</dt><dd><ul class="simple">
<li><p><a href="#id9"><span class="problematic" id="id10">*</span></a>file : path to ASCII files containing the precomputed models</p></li>
<li><dl class="simple">
<dt>showadaf<span class="classifier">should I display the three ADAF models? (list or array of booleans, </span></dt><dd><p>e.g., [True,True,True])</p>
</dd>
</dl>
</li>
<li><p>showthin : Include thin disk?</p></li>
<li><p>showjet : Display jet?</p></li>
<li><p>showsum : Show sum of components?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.obsplot">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">obsplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/Dropbox/work/projects/finished/liners/tables/models.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/Dropbox/work/projects/finished/liners/seds/obsdata/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#obsplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.obsplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the observed SED taken from the Eracleous et al. sample. Includes arrows 
for upper limits and the nice bow tie.</p>
<p>Extinction corrections represented as either “error bars” or “circle + error bar”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – source name e.g. ‘NGC1097’ or ‘ngc1097’ or ‘NGC 1097’. Must have four numbers.</p></li>
<li><p><strong>table</strong> – path of ASCII table models.csv with the required SED parameters gammax, error in gammax, X-ray luminosity and distratio</p></li>
<li><p><strong>patho</strong> – path to observed SED data files</p></li>
<li><p><strong>ext</strong> – 0 for showing extinction corrections as “error bars”; 1 for “circle + error bar”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED object with distance-corrected luminosities</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.obsplot1097">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">obsplot1097</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#obsplot1097"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.obsplot1097" title="Permalink to this definition">¶</a></dt>
<dd><p>Modification of the plot method to handle the nice data of NGC 1097.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – source name e.g. ‘NGC1097’ or ‘ngc1097’ or ‘NGC 1097’. Must have four numbers.</p></li>
<li><p><strong>o</strong> – observed SED data points imported using the SED class and the erac method.</p></li>
<li><p><strong>table</strong> – path of ASCII table models.csv with the required SED parameters gammax, error in gammax, X-ray luminosity and distratio.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED object with distance-corrected luminosities</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.pionDecay">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">pionDecay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proton_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photon_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#pionDecay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.pionDecay" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the gamma-ray spectrum from pp collisions followed by pion decay for the full 
RIAF computed by my semi-analytical model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfile</strong> – log file generated by the semi-analytical RIAF model, containing the electron number density and ion temperature. e.g. ‘cd ~/science/projects/adafjet/adaf/perl/run01/out_01’</p></li>
<li><p><strong>parfile</strong> – parameter file used as input by the semi-analytical RIAF model, containing the black hole mass and other model parameters. e.g. ‘cd ~/science/projects/adafjet/adaf/perl/run01/in.dat’</p></li>
<li><p><strong>alpha</strong> – power-law index</p></li>
<li><p><strong>E0</strong> – reference energy. Default = proton_mass*c^2 ~ 1 GeV</p></li>
<li><p><strong>proton_energy</strong> – array of proton energies, e.g. logspace(0, 6, 50) * astropy.units.MeV</p></li>
<li><p><strong>photon_energy</strong> – array of photon energies for SED. If None, taken as the same as proton_energy. In astropy.units</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SED object in units of Hz vs erg/s</p>
</dd>
</dl>
<p>Example:</p>
<p>Computes gamma-ray SED with default particle DF options and power-law index. Issue
the command below in the directory with model datafiles.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">=</span><span class="n">nmmn</span><span class="o">.</span><span class="n">sed</span><span class="o">.</span><span class="n">pionDecay</span><span class="p">(</span><span class="s1">&#39;out_01&#39;</span><span class="p">,</span><span class="s1">&#39;in.dat&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">lognu</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">ll</span><span class="p">)</span>
</pre></div>
</div>
<p>Based on the jupyter notebook “gamma-rays RIAF”.</p>
<p>References about pion decay physics:
• Oka &amp; Manmoto 2003: overview of calculation
• Fatuzzo &amp; Melia 2003: overview of calculation
• Dermer 1986: formulas</p>
<p>naima model:
• Kafexhiu, E., Aharonian, F., Taylor, A.M., &amp; Vila, G.S. 2014, Physical Review D, 90, 123014
• Zabalza 2015</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.plot">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED. Split these method in separate units: modelplot, obsplot, plotprops.
Main method to create the SED plot.</p>
<p>Arguments:
- source: source name e.g. ‘NGC1097’ or ‘ngc1097’ or ‘NGC 1097’. Must have four</p>
<blockquote>
<div><p>numbers.</p>
</div></blockquote>
<ul class="simple">
<li><p>o: observed SED data points imported using the SED class and the erac method.</p></li>
<li><dl class="simple">
<dt>m: dictionary with the different model components created with the method</dt><dd><p>groupmodel below.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>table: path of ASCII table models.csv with the required SED parameters gammax, </dt><dd><p>error in gammax, X-ray luminosity and distratio.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.plotprops">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">plotprops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labelfontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#plotprops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.plotprops" title="Permalink to this definition">¶</a></dt>
<dd><p>Define other properties of the SED plot: additional axis, font size etc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.popstar">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">popstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#popstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.popstar" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the stellar population spectrum, finds the required mass and plots its
SED.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>o</strong> – object containing the observed SED</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fitted stellar population mass</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.powerlaw">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">powerlaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nurange</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#powerlaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.powerlaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the X-ray powerlaw variables.</p>
<p>Arguments:
- alpha: spectral power-law index
- Lx: total luminosity in X-rays in the nurange</p>
<blockquote>
<div><ul class="simple">
<li><p>nurange: two-element list or array with range of frequencies to plot,</p></li>
</ul>
<blockquote>
<div><p>in keV. e.g. [2,10]</p>
</div></blockquote>
</div></blockquote>
<p>Returns the sequence of arrays log10(nu),log10(nu*Lnu) for plotting.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.sum">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of SEDs previously interpolated in the same binning, 
sums their luminosities and returns a SED object with the sum.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span><span class="o">=</span><span class="nb">sum</span><span class="p">([</span><span class="n">s</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">])</span>
</pre></div>
</div>
<p>returns the SED ss &lt;- [lognu, s+s1+s2],
where s+s1+s2 -&gt; log10[nuLnu(s)+nuLnu(s1)+nuLnu(s2)], lognu being the common 
units of frequency for the SEDs after interpolation.</p>
<p>The method is designed to automatically call the interp method for each SED
if needed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.xray">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">xray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L2_10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammaerru</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammaerrl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nurange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2.0,</span> <span class="pre">10.0]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#xray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.xray" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots X-ray “bow tie”, provided the X-ray luminosity in the 2-10 keV range,
the best-fit photon index and the error in this index.</p>
<p>Arguments:
- L2_10: X-ray luminosity in the 2-10 keV range, erg/s
- gammax: best-fit photon index
- gammaerru, gammaerrl: upper and lower 1sigma error bars on the value of</p>
<blockquote>
<div><blockquote>
<div><p>gammax</p>
</div></blockquote>
<ul class="simple">
<li><p>nurange: two-element list or array with range of frequencies to plot,</p></li>
</ul>
<blockquote>
<div><p>in keV. e.g. [2,10]</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.sed.xrayinset">
<span class="sig-prename descclassname"><span class="pre">nmmn.sed.</span></span><span class="sig-name descname"><span class="pre">xrayinset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jetf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sumf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/nemmen/Dropbox/work/projects/finished/liners/tables/models.csv'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/sed.html#xrayinset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.sed.xrayinset" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots an inset with the zoomed-in X-ray spectra.</p>
</dd></dl>

</section>
</section>
<section id="module-nmmn.stats">
<span id="nmmn-stats-module"></span><h2>nmmn.stats module<a class="headerlink" href="#module-nmmn.stats" title="Permalink to this headline">¶</a></h2>
<section id="statistical-methods">
<h3>Statistical methods<a class="headerlink" href="#statistical-methods" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>fit residuals</p></li>
<li><p>Computing prediction and confidence bands</p></li>
<li><p>Comparing goodness-of-fit of different models</p></li>
<li><p>operations on statistical distributions</p></li>
<li><p>custom statistical distributions</p></li>
<li><p>p-values and significance</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.aic">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">aic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#aic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.aic" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Akaike information criterion which is “a measure of the relative goodness of
fit of a statistical model”. Unlike the F-test, it does not assume that one model is 
a particular case of the more complex one. If errors==False then assume the
errors are the same for every data point. Otherwise, assumes you are providing
the chi-squared values instead of RSS.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aic</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">rss</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rss</strong> – residual sum of squares for the model in case errors=False, otherwise assumes you are giving the chi-square values</p></li>
<li><p><strong>n</strong> – sample size, i.e. number of data points</p></li>
<li><p><strong>k</strong> – number of free parameters in the model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>AIC statistic</p>
</dd>
</dl>
<p>References:</p>
<ol class="arabic simple">
<li><p>Documentation for Origin software on fit comparison: <a class="reference external" href="http://www.originlab.com/index.aspx?go=Products/Origin/DataAnalysis/CurveFitting/NonlinearFitting&amp;pid=1195">http://www.originlab.com/index.aspx?go=Products/Origin/DataAnalysis/CurveFitting/NonlinearFitting&amp;pid=1195</a> (first heard about this test there)</p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/Akaike_information_criterion">http://en.wikipedia.org/wiki/Akaike_information_criterion</a></p></li>
</ol>
<p>v1 Dec 2011</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.bic">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">bic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#bic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.bic" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Bayesian information criterion which is “a criterion for model selection
among a finite set of models”. From wikipedia: “The BIC […] introduces a 
penalty term for the number of parameters in the model. The penalty term is larger 
in BIC than in AIC.”</p>
<p>In order to use BIC to quantify the evidence against a specific model, check out
the section “use of BIC” in the presentation “171:290 Model Selection, Lecture VI: 
The Bayesian Information Criterion” by Joseph Cavanaugh 
(<a class="reference external" href="http://myweb.uiowa.edu/cavaaugh/ms_lec_6_ho.pdf">http://myweb.uiowa.edu/cavaaugh/ms_lec_6_ho.pdf</a>).</p>
<p>If errors==False then assume the errors are the same for every data point. 
Otherwise, assumes you are providing the chi-squared values instead of RSS.</p>
<p>Usage:
&gt;&gt;&gt; bic = bic(k,n,rss)</p>
<p>Arguments:
- rss : residual sum of squares for the model in case errors=False, otherwise assumes you are giving the chi-square values
- n : sample size, i.e. number of data points
- k : number of free parameters in the model</p>
<p>Returns: BIC statistic</p>
<p>References:
1. <a class="reference external" href="http://en.wikipedia.org/wiki/Bayesian_information_criterion">http://en.wikipedia.org/wiki/Bayesian_information_criterion</a>
2. Model Selection, Lecture VI: The Bayesian Information Criterion” by Joseph Cavanaugh (<a class="reference external" href="http://myweb.uiowa.edu/cavaaugh/ms_lec_6_ho.pdf">http://myweb.uiowa.edu/cavaaugh/ms_lec_6_ho.pdf</a>)</p>
<p>v1 Apr 2012</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.bootcorr">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">bootcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nboot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#bootcorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.bootcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given (X,Y) data points with intrinsic scatter, computes the 
bootstrapped Pearson and Spearman correlation coefficients. This
will give you an idea of how much outliers affect your correlation.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span><span class="n">rho</span><span class="o">=</span><span class="n">bootcorr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">100000</span><span class="p">)</span>
</pre></div>
</div>
<p>performs 100000 bootstrapping realizations on the arrays x and y.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>r</em> - array with bootstrapped Pearson statistics</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>rho</em> - bootstrapped array with Spearman statistics</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.chisq">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">chisq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#chisq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.chisq" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chi-square error statistic as the sum of squared errors between
Y(i) and AX(i) + B. If individual standard deviations (array sd) are supplied, 
then the chi-square error statistic is computed as the sum of squared errors
divided by the standard deviations.     Inspired on the IDL procedure linfit.pro.
See <a class="reference external" href="http://en.wikipedia.org/wiki/Goodness_of_fit">http://en.wikipedia.org/wiki/Goodness_of_fit</a> for reference.</p>
<p>If a linear model is not provided via A,B (y=ax+b) then the method computes
the chi-square using the best-fit line.</p>
<p>x,y,sd assumed to be Numpy arrays. a,b scalars.
Returns the float chisq with the chi-square statistic.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.chisqg">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">chisqg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#chisqg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.chisqg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chi-square error statistic as the sum of squared errors between
Ydata(i) and Ymodel(i). If individual standard deviations (array sd) are supplied, 
then the chi-square error statistic is computed as the sum of squared errors
divided by the standard deviations.     Inspired on the IDL procedure linfit.pro.
See <a class="reference external" href="http://en.wikipedia.org/wiki/Goodness_of_fit">http://en.wikipedia.org/wiki/Goodness_of_fit</a> for reference.</p>
<p>x,y,sd assumed to be Numpy arrays. a,b scalars.
Returns the float chisq with the chi-square statistic.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.chisqxy">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">chisqxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#chisqxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.chisqxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chi-square error statistic for a linear fit, 
computed taking into account the errors in both X and Y (i.e. the
effective variance). See equation 3 in Ascenso et al. 2012, A&amp;A or
Yee &amp; Ellingson 2003 ApJ.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chisq</span><span class="o">=</span><span class="n">chisqxy</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">errx</span><span class="p">,</span><span class="n">erry</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p>xdata,ydata : data</p></li>
<li><p>errx,erry : measurement uncertainties in the data</p></li>
<li><p>a,b : slope and intercept of the best-fit linear regression model</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.conf2sig">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">conf2sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#conf2sig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.conf2sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a confidence p-value, translates it into standard deviations.
E.g., p=0.683 -&gt; 1sigma, p=0.954 -&gt; 2sigma, etc.</p>
<p>Inspired on p2sig method.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">conf2sig</span><span class="p">(</span><span class="mf">0.683</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.confband">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">confband</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#confband"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.confband" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the confidence band of the linear regression model at the desired confidence
level, using analytical methods. The 2sigma confidence interval is 95% sure to contain 
the best-fit regression line. This is not the same as saying it will contain 95% of 
the data points.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>conf: desired confidence level, by default 0.95 (2 sigma)</p></li>
<li><p>xd,yd: data arrays</p></li>
<li><p>a,b: linear fit parameters as in y=ax+b</p></li>
<li><p>x: (optional) array with x values to calculate the confidence band. If none is provided, will by default generate 100 points in the original x-range of the data.</p></li>
</ul>
<p>Returns:
Sequence (lcb,ucb,x) with the arrays holding the lower and upper confidence bands 
corresponding to the [input] x array.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lcb</span><span class="p">,</span><span class="n">ucb</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">confband</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">,</span><span class="nb">all</span><span class="o">.</span><span class="n">lg</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">conf</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="go">calculates the confidence bands for the given input arrays</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lcb</span><span class="p">,</span> <span class="n">ucb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">plots a shaded area containing the confidence band</span>
</pre></div>
</div>
<p>References:
1. <a class="reference external" href="http://en.wikipedia.org/wiki/Simple_linear_regression">http://en.wikipedia.org/wiki/Simple_linear_regression</a>, see Section Confidence intervals
2. <a class="reference external" href="http://www.weibull.com/DOEWeb/confidence_intervals_in_simple_linear_regression.htm">http://www.weibull.com/DOEWeb/confidence_intervals_in_simple_linear_regression.htm</a></p>
<p>v1 Dec. 2011
v2 Jun. 2012: corrected bug in computing dy</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.confbandmc">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">confbandmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#confbandmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.confbandmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the 1sigma confidence band of a linear model without needing
to specify the data points, by doing a Monte Carlo simulation using the
Multivariate normal distribution. Assumes the parameters follow a 2D
normal distribution.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>x: array with x values to calculate the confidence band.</p></li>
<li><p>par : array or list with structure [par0, par1, par2, …] with the best-fit
parameters</p></li>
<li><p>varcov : variance-covariance matrix of the parameters</p></li>
<li><p>n : number of (a,b) points generated from the multivariate gaussian</p></li>
<li><p>sigmas : number of standard deviations contained within the prediction
band</p></li>
</ul>
<p>Output:</p>
<ul class="simple">
<li><p>lcb, ucb : lower and upper prediction bands</p></li>
<li><p>y : values of the model tabulated at x</p></li>
</ul>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lcb</span><span class="p">,</span><span class="n">ucb</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">confbandmc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bfit</span><span class="p">,</span><span class="n">bcov</span><span class="p">)</span>
<span class="go">calculates the prediction bands for the given input arrays</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lcb</span><span class="p">,</span> <span class="n">ucb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">plots a shaded area containing the prediction band</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.confbandnl">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">confbandnl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#confbandnl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.confbandnl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the confidence band of a nonlinear model at the desired confidence
level, using analytical methods.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>xd,yd: data arrays</p></li>
<li><p>fun : function f(v) - the model - which returns a scalar. v is an array
such that v[0]=x (scalar), v[i&gt;0] = parameters of the model</p></li>
<li><p>par : array or list with structure [par0, par1, par2, …] with the best-fit
parameters that will be fed into fun</p></li>
<li><p>varcov : variance-covariance matrix obtained from the nonlinear fit</p></li>
<li><p>deg : number of free parameters in the model</p></li>
<li><p>conf: desired confidence level, by default 0.95 (2 sigma)</p></li>
<li><p>x: (optional) array with x values to calculate the confidence band. If none is provided, will
by default generate 100 points in the original x-range of the data.</p></li>
</ul>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lcb</span><span class="p">,</span><span class="n">ucb</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">confbandnl</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">,</span><span class="nb">all</span><span class="o">.</span><span class="n">lg</span><span class="p">,</span><span class="n">broken</span><span class="p">,</span><span class="n">bfit</span><span class="p">,</span><span class="n">bcov</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">conf</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="go">calculates the confidence bands for the given input arrays</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lcb</span><span class="p">,</span> <span class="n">ucb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">plots a shaded area containing the prediction band  </span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sequence (lcb,ucb,x) with the arrays holding the lower and upper confidence bands</p>
</dd>
</dl>
<p>corresponding to the [input] x array.</p>
<p>References:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://www.graphpad.com/faq/viewfaq.cfm?faq=1099">How does Prism compute confidence and prediction bands for nonlinear regression?</a></p></li>
<li><p><a class="reference external" href="http://stats.stackexchange.com/questions/15423/how-to-compute-prediction-bands-for-non-linear-regression">http://stats.stackexchange.com/questions/15423/how-to-compute-prediction-bands-for-non-linear-regression</a></p></li>
<li><p>see also my notebook</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.credbandmc">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">credbandmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#credbandmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.credbandmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the confidence (or credibility in case of Bayesian analysis) 
band of a linear regression model, given the posterior probability distributions
of the slope and intercept (presumably computed via Bayesian regression,
see bayeslin.pro). These distributions do not need to be normal.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>x: array with x values to calculate the confidence band.</p></li>
<li><p>slope, inter: posterior distributions of slope and intercept for linear
regression</p></li>
<li><p>sigmas : number of standard deviations contained within the confidence
band</p></li>
</ul>
<p>Output:</p>
<ul class="simple">
<li><p>lcb, ucb : lower and upper confidence bands</p></li>
<li><p>y : best-fit values of the model tabulated at x</p></li>
</ul>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lcb</span><span class="p">,</span><span class="n">ucb</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">predbandmc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="go">calculates the prediction bands for the given input arrays</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lcb</span><span class="p">,</span> <span class="n">ucb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">plots a shaded area containing the prediction band</span>
</pre></div>
</div>
<p>v1 Jun. 2012: inspired by private communication with B. Kelly.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.fitstats">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">fitstats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#fitstats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.fitstats" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes different useful statistics for the given (X +- errX, Y +- errY)
arrays of data. Also quantifies the goodness-of-fit of the provided
linear fit with slope ‘a’ and intercept ‘b’.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">rchisq</span><span class="p">,</span><span class="n">scat</span><span class="p">,</span><span class="n">iscat</span><span class="p">,</span><span class="n">r2</span><span class="o">=</span><span class="n">fitstats</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">errx</span><span class="p">,</span><span class="n">erry</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param xdata,ydata</dt>
<dd class="field-odd"><p>data</p>
</dd>
<dt class="field-even">param errx,erry</dt>
<dd class="field-even"><p>measurement uncertainties in the data</p>
</dd>
<dt class="field-odd">param a,b</dt>
<dd class="field-odd"><p>slope and intercept of the best-fit linear regression model</p>
</dd>
</dl>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><ul class="simple">
<li><p>Pearson ‘r’</p></li>
<li><p>Spearman ‘rho’</p></li>
<li><p>Reduced chi-squared ‘chi^2_nu’</p></li>
<li><p>raw scatter about the best-fit</p></li>
<li><p>intrinsic scatter</p></li>
<li><p>Coefficient of determination ‘R^2’</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.ftest">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">ftest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rss1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rss2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#ftest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.ftest" title="Permalink to this definition">¶</a></dt>
<dd><p>Carries out the F-test to decide which model fits the data better.
Computes the F statistic, associated p-value and the significance
in sigmas with which we can reject the null hypothesis. You can also
give the <span class="math notranslate nohighlight">\(\chi^2\)</span> values instead of RSS if you have y-errors.</p>
<p>Note that p2&gt;p1 must be obeyed, i.e. model 2 is “nested” within model 1.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fstat</span><span class="p">,</span><span class="n">pvalue</span><span class="p">,</span><span class="n">conf</span> <span class="o">=</span> <span class="n">ftest</span><span class="p">(</span><span class="n">rss1</span><span class="p">,</span><span class="n">rss2</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
<p>Arguments:
- rss1, rss2 : residual sum of squares for models 1 and 2
- n : sample size, i.e. number of data points
- p1, p2 : number of free parameters in the models</p>
<p>Returns:
- fstat : the F statistic
- pvalue : p-value associated with the F statistic
- conf : significance in sigmas with which we can reject the null hypothesis</p>
<p>References:
1. <a class="reference external" href="http://en.wikipedia.org/wiki/F-test">http://en.wikipedia.org/wiki/F-test</a>
2. <a class="reference external" href="http://graphpad.com/curvefit/2_models__1_dataset.htm">http://graphpad.com/curvefit/2_models__1_dataset.htm</a>, Graphpad.com, Comparing the fits of two models (CurveFit.com)</p>
<p>v1 Dec. 2011
v2 Jan 16 2012: added comment regarding y-errors</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.gauss2d">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">gauss2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#gauss2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.gauss2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates random numbers drawn from the multinormal distribution in
two dimensions. Computes also the probability associated with each
number that can be used to computed confidence levels.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>par : array or list with structure [par0, par1, par2, …] with the best-fit
parameters</p></li>
<li><p>varcov : variance-covariance matrix of the parameters</p></li>
<li><p>n : number of (a,b) points generated from the multivariate gaussian</p></li>
</ul>
<p>Output:</p>
<ul class="simple">
<li><p>x,y : arrays of random values generated from the multinormal distribution</p></li>
<li><p>prob : probability associated with each value</p></li>
</ul>
<p>Usage:
&gt;&gt;&gt; x,y,prob=gauss2d(par,varcov,100000)</p>
<p>v1 Apr. 2012</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.gen_ts">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">gen_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#gen_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.gen_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a time series (TS) with uncertainties on the signal, this will generate 
<em>n</em> new TS with y-values distributed according to the error bars.</p>
<p>Output will be a <span class="math notranslate nohighlight">\(n \times {
m{size}(t)}\)</span> array. Each row of this
array contains a simulated TS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – array of y-values for time series (do not need to be in order)</p></li>
<li><p><strong>erry</strong> – array of 1-sigma errors on y-values</p></li>
<li><p><strong>n</strong> – number of Mock TS to generate</p></li>
<li><p><strong>zeropad</strong> – are y-values&lt;0 not allowed? <cite>True</cite> will make any values&lt;0 into 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>n x size(t)</cite> array. Each row of this array contains a simulated TS</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.intscat">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">intscat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#intscat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.intscat" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the intrinsic scatter about the best-fit, taking into account
the errors in X and Y and the “raw” scatter. Inspired by Pratt et al. 2009,
A&amp;A, 498, 361.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">=</span><span class="n">intscat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">errx</span><span class="p">,</span><span class="n">erry</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p>x,y : X and Y data arrays</p></li>
<li><p>errx, erry : standard deviations in X and Y</p></li>
<li><p>a,b : slope and intercept of best-fit linear relation</p></li>
</ul>
<p>Returns the float sd with the scatter about the best-fit.</p>
<p>v1 Apr 9th 2012</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.linregress_error">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">linregress_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#linregress_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.linregress_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the uncertainties in the parameters A,B of the least-squares
linear regression fit y=ax+b to the data (scipy.stats.linregress).</p>
<p>x,y assumed to be Numpy arrays.
Returns the sequence sigma_a, sigma_b with the standard deviations in A and B.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.mode">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the mode of a distribution, i.e. the value where the PDF peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – input list/array with the distribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.p2sig">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">p2sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#p2sig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.p2sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the p-value Pnull (i.e. probability of the null hypothesis) below, 
evaluates the confidence level with which we can reject the hypothesis in standard 
deviations.</p>
<p>Inspired on prob2sig.nb.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">p2sig</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.predband">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">predband</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#predband"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.predband" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the prediction band of the linear regression model at the desired confidence
level, using analytical methods.</p>
<p>Clarification of the difference between confidence and prediction bands:
“The 2sigma confidence interval is 95% sure to contain the best-fit regression line. 
This is not the same as saying it will contain 95% of the data points. The prediction bands are
further from the best-fit line than the confidence bands, a lot further if you have many data 
points. The 95% prediction interval is the area in which you expect 95% of all data points to fall.”
(from <a class="reference external" href="http://graphpad.com/curvefit/linear_regression.htm">http://graphpad.com/curvefit/linear_regression.htm</a>)</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>conf: desired confidence level, by default 0.95 (2 sigma)</p></li>
<li><p>xd,yd: data arrays</p></li>
<li><p>a,b: linear fit parameters as in y=ax+b</p></li>
<li><p>x: (optional) array with x values to calculate the confidence band. If none is provided, will
by default generate 100 points in the original x-range of the data.</p></li>
</ul>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lpb</span><span class="p">,</span><span class="n">upb</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">predband</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">,</span><span class="nb">all</span><span class="o">.</span><span class="n">lg</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">conf</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="go">calculates the prediction bands for the given input arrays</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lpb</span><span class="p">,</span> <span class="n">upb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">plots a shaded area containing the prediction band  </span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sequence (lpb,upb,x) with the arrays holding the lower and upper confidence bands</p>
</dd>
</dl>
<p>corresponding to the [input] x array.</p>
<p>References:</p>
<p>1. <a class="reference external" href="http://www.JerryDallal.com/LHSP/slr.htm">Introduction to Simple Linear Regression, Gerard 
E. Dallal, Ph.D.</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.predbandnl">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">predbandnl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#predbandnl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.predbandnl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the prediction band of a nonlinear model at the desired confidence
level, using analytical methods.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>xd,yd: data arrays</p></li>
<li><p>fun : function f(v) - the model - which returns a scalar. v is an array
such that v[0]=x, v[i&gt;0] = parameters of the model</p></li>
<li><p>par : array or list with structure [par0, par1, par2, …] with the best-fit
parameters that will be fed into fun</p></li>
<li><p>varcov : variance-covariance matrix obtained from the nonlinear fit</p></li>
<li><p>deg : number of free parameters in the model</p></li>
<li><p>conf: desired confidence level, by default 0.95 (2 sigma)</p></li>
<li><p>x: (optional) array with x values to calculate the confidence band. If none is provided, will
by default generate 100 points in the original x-range of the data.</p></li>
</ul>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lpb</span><span class="p">,</span><span class="n">upb</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">nemmen</span><span class="o">.</span><span class="n">predbandnl</span><span class="p">(</span><span class="nb">all</span><span class="o">.</span><span class="n">kp</span><span class="p">,</span><span class="nb">all</span><span class="o">.</span><span class="n">lg</span><span class="p">,</span><span class="n">broken</span><span class="p">,</span><span class="n">bfit</span><span class="p">,</span><span class="n">bcov</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">conf</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="go">calculates the prediction bands for the given input arrays</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lpb</span><span class="p">,</span> <span class="n">upb</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">plots a shaded area containing the prediction band  </span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sequence (lpb,upb,x) with the arrays holding the lower and upper confidence bands</p>
</dd>
</dl>
<p>corresponding to the [input] x array.</p>
<p>References:
1. <a class="reference external" href="http://www.graphpad.com/faq/viewfaq.cfm?faq=1099">http://www.graphpad.com/faq/viewfaq.cfm?faq=1099</a>, “How does Prism compute confidence and prediction bands for nonlinear regression?”
2. <a class="reference external" href="http://stats.stackexchange.com/questions/15423/how-to-compute-prediction-bands-for-non-linear-regression">http://stats.stackexchange.com/questions/15423/how-to-compute-prediction-bands-for-non-linear-regression</a>
3. see also my notebook)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.r2">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymod</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.r2" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the “coefficient of determination” R^2. According to wikipedia,
“It is the proportion of variability in a data set that is accounted for 
by the statistical model. It provides a measure of how well future outcomes 
are likely to be predicted by the model.”</p>
<p>This method was inspired by <a class="reference external" href="http://stackoverflow.com/questions/3460357/calculating-the-coefficient-of-determination-in-python">http://stackoverflow.com/questions/3460357/calculating-the-coefficient-of-determination-in-python</a></p>
<p>References:
1. <a class="reference external" href="http://en.wikipedia.org/wiki/Coefficient_of_determination">http://en.wikipedia.org/wiki/Coefficient_of_determination</a>
2. <a class="reference external" href="http://stackoverflow.com/questions/3460357/calculating-the-coefficient-of-determination-in-python">http://stackoverflow.com/questions/3460357/calculating-the-coefficient-of-determination-in-python</a></p>
<p>v1 Apr 18th 2012</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.r2p">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">r2p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#r2p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.r2p" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a value of the Pearson r coefficient, this method gives the
corresponding p-value of the null hypothesis (i.e. no correlation).</p>
<p>Code copied from scipy.stats.pearsonr source.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">=</span><span class="n">r2p</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>where ‘r’ is the Pearson coefficient and n is the number of data
points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>p-value of the null hypothesis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.random">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#random"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an array of random uniformly distributed floats in the 
interval <em>[x0,x1)</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.random_normal">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">random_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#random_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.random_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of n elements of random variables, following a normal 
distribution with the supplied mean and standard deviation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>this is superseded. Use <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.normal.html">numpy.random.normal</a> instead.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.randomvariate">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">randomvariate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#randomvariate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.randomvariate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rejection method for random number generation:
Uses the rejection method for generating random numbers derived from an arbitrary 
probability distribution. For reference, see Bevington’s book, page 84. Based on
rejection*.py.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">randomvariate</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>where</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> – probability distribution function from which you want to generate random numbers</p></li>
<li><p><strong>N</strong> – desired number of random values</p></li>
<li><p><strong>xmin</strong><strong>,</strong><strong>xmax</strong> – range of random numbers desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the sequence (ran,ntrials) where
ran : array of shape N with the random variates that follow the input P
ntrials : number of trials the code needed to achieve N</p>
</dd>
</dl>
<p>Here is the algorithm:</p>
<ul class="simple">
<li><p>generate x’ in the desired range</p></li>
<li><p>generate y’ between Pmin and Pmax (Pmax is the maximal value of your pdf)</p></li>
<li><p>if y’&lt;P(x’) accept x’, otherwise reject</p></li>
<li><p>repeat until desired number is achieved</p></li>
</ul>
<p>v1 Nov. 2011</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.redchisq">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">redchisq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#redchisq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.redchisq" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns the reduced chi-square error statistic for a linear fit:</dt><dd><p>chisq/nu</p>
</dd>
</dl>
<p>where nu is the number of degrees of freedom. If individual standard deviations 
(array sd) are supplied, then the chi-square error statistic is computed as the 
sum of squared errors divided by the standard deviations. 
See <a class="reference external" href="http://en.wikipedia.org/wiki/Goodness_of_fit">http://en.wikipedia.org/wiki/Goodness_of_fit</a> for reference.</p>
<p>If a linear model is not provided via A,B (y=ax+b) then the method computes
the chi-square using the best-fit line.</p>
<p>x,y,sd assumed to be Numpy arrays. a,b scalars. deg integer.
Returns the float chisq/nu with the reduced chi-square statistic.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.redchisqg">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">redchisqg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#redchisqg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.redchisqg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reduced chi-square error statistic for an arbitrary model, 
chisq/nu, where nu is the number of degrees of freedom. If individual 
standard deviations (array sd) are supplied, then the chi-square error 
statistic is computed as the sum of squared errors divided by the standard 
deviations. See <a class="reference external" href="http://en.wikipedia.org/wiki/Goodness_of_fit">http://en.wikipedia.org/wiki/Goodness_of_fit</a> for reference.</p>
<p>ydata,ymod,sd assumed to be Numpy arrays. deg integer.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chisq</span><span class="o">=</span><span class="n">redchisqg</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span><span class="n">ymod</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">sd</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p>ydata : data</p></li>
<li><p>ymod : model evaluated at the same x points as ydata</p></li>
<li><p>n : number of free parameters in the model</p></li>
<li><p>sd : uncertainties in ydata</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.redchisqxy">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">redchisqxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#redchisqxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.redchisqxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reduced chi-square error statistic for a linear fit <span class="math notranslate nohighlight">\(\chi^2/
u\)</span>
where nu is the number of degrees of freedom. The chi-square statistic is
computed taking into account the errors in both X and Y (i.e. the
effective variance). See equation 3 in Ascenso et al. 2012, A&amp;A or
Yee &amp; Ellingson 2003 ApJ.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chisq</span><span class="o">=</span><span class="n">redchisqxy</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">errx</span><span class="p">,</span><span class="n">erry</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p>xdata,ydata : data</p></li>
<li><p>errx,erry : measurement uncertainties in the data</p></li>
<li><p>a,b : slope and intercept of the best-fit linear regression model</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.residual">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymod</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the residual sum of squares (RSS) also known as the sum of 
squared residuals (see <a class="reference external" href="http://en.wikipedia.org/wiki/Residual_sum_of_squares">http://en.wikipedia.org/wiki/Residual_sum_of_squares</a>).</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rss</span><span class="o">=</span><span class="n">residual</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span><span class="n">ymod</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>where</dt><dd><p>ydata : data
ymod : model evaluated at xdata</p>
</dd>
</dl>
<p>ydata,ymod assumed to be Numpy arrays. 
Returns the float rss with the mean deviation.</p>
<p>Dec. 2011</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.scatpratt">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">scatpratt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#scatpratt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.scatpratt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is an alternative way of computing the “raw” scatter about the best-fit 
linear relation in the presence of measurement errors, proposed by 
Pratt et al. 2009, A&amp;A, 498, 361.</p>
<p>In the words of Cavagnolo et al. (2010): 
<em>We have quantified the total scatter about the best-fit relation using a 
weighted estimate of the orthogonal distances to the best-fit line (see 
Pratt et al. 2009).</em></p>
<p>Usage:</p>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sd=scatpratt(x,y,errx,erry,a,b)</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> – X and Y data arrays</p></li>
<li><p><strong>erry</strong> (<em>errx</em><em>,</em>) – standard deviations in X and Y</p></li>
<li><p><strong>a</strong><strong>,</strong><strong>b</strong> – slope and intercept of best-fit linear relation</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float sd with the scatter about the best-fit.</p>
</dd>
</dl>
</dd></dl>

<p>v1 Mar 20 2012</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.scatterfit">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">scatterfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#scatterfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.scatterfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mean deviation of the data about the linear model given if A,B
(<em>y=ax+b</em>) provided as arguments. Otherwise, compute the mean deviation about 
the best-fit line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> – assumed to be Numpy arrays.</p></li>
<li><p><strong>a</strong><strong>,</strong><strong>b</strong> – scalars.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float sd with the mean deviation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.scatterfitg">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">scatterfitg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#scatterfitg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.scatterfitg" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mean deviation of the data about the model given in
the array ymod, tabulated exactly like ydata.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sd</span><span class="o">=</span><span class="n">scatterfitg</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span><span class="n">ymod</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ydata</strong> – data</p></li>
<li><p><strong>ymod</strong> – model evaluated at xdata</p></li>
<li><p><strong>n</strong> – number of free parameters in the model</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float sd with the mean deviation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.sig2conf">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">sig2conf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#sig2conf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.sig2conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a number of std. deviations, translates it into a p-value.
E.g., 1sigma -&gt; p=0.683, 2sigma -&gt; p=0.954, etc.</p>
<p>Inspired on p2sig method.</p>
<p>Usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">sig2conf</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.splitnorm">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">splitnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#splitnorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.splitnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Split normal distribution (or asymmetric gaussian) PDF. Useful when dealing
with asymmetric error bars.</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Split_normal_distribution">http://en.wikipedia.org/wiki/Split_normal_distribution</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input array where the PDF will be computed</p></li>
<li><p><strong>sig1</strong> – left standard deviation</p></li>
<li><p><strong>sig2</strong> – right std. dev.</p></li>
<li><p><strong>mu</strong> – mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>probability distribution function for the array x</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nmmn.stats.splitnorm_gen">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">splitnorm_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">momtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">badvalue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extradoc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#splitnorm_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.splitnorm_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats._distn_infrastructure.rv_continuous</span></code></p>
<p>Split normal distribution defined using scipy.stats. Can be called as 
any scipy.stats distribution. I took the effort of defining the extra
CDF and PPF methods below in order to speedup calls to this class 
(I have particularly in mind the package <em>mcerp</em>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input array where the PDF will be computed</p></li>
<li><p><strong>sig1</strong> – left standard deviation</p></li>
<li><p><strong>sig2</strong> – right std. dev.</p></li>
<li><p><strong>mu</strong> – mode</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<p>Defines distribution with sig1=1, sig2=3, mu=0:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split</span> <span class="o">=</span> <span class="n">splitnorm_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;splitnorm&#39;</span><span class="p">,</span> <span class="n">shapes</span><span class="o">=</span><span class="s1">&#39;sig1, sig2, mu&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes PDF:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes CDF:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Generates 100 random numbers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>for some reason, this fails if mu=0.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nmmn.stats.splitstd">
<span class="sig-prename descclassname"><span class="pre">nmmn.stats.</span></span><span class="sig-name descname"><span class="pre">splitstd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nmmn/stats.html#splitstd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmmn.stats.splitstd" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the input distribution, this method computes two standard deviations:
the left and right side spreads. This is especially useful if you are dealing
with a split normal distribution from your data and you want to quantify the
lower and upper error bars without having to fit a split normal distribution.</p>
<p>This is a quick nonparametric method, as opposed to the more computationally
intensive minimization involved when fitting a function.</p>
<p>Algorithm:</p>
<ul class="simple">
<li><p>divide the original distribution in two distributions at the mode</p></li>
<li><p>create two new distributions, which are the symmetrical versions of the left and right side of the original one</p></li>
<li><p>compute the standard deviations for the new mirror distributions</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – array or list containing the distribution</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>left.stddev, right.stddev</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>do not forget to inspect <em>x</em>.</p>
</div>
</dd></dl>

</section>
</section>
<section id="module-nmmn">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nmmn" title="Permalink to this headline">¶</a></h2>
<p>Miscellaneous modules for:</p>
<ul class="simple">
<li><p><cite>astro</cite>: astronomy</p></li>
<li><p><cite>dsp</cite>: signal processing</p></li>
<li><p><cite>lsd</cite>: misc. operations on arrays, lists, dictionaries and sets</p></li>
<li><p><cite>stats</cite>: statistical methods</p></li>
<li><p><cite>plots</cite>: custom plots</p></li>
<li><p><cite>fermi</cite>: Fermi LAT analysis methods</p></li>
<li><p><cite>bayes</cite>: Bayesian tools for dealing with posterior distributions</p></li>
<li><p><cite>grmhd</cite>: tools for dealing with GRMHD numerical simulations</p></li>
<li><p><cite>finance</cite>: financial market</p></li>
</ul>
<p>These are modules I wrote which I find useful – for whatever reason – in my research.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">nmmn</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">nmmn package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.astro">nmmn.astro module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#astrophysical-routines">Astrophysical routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.bayes">nmmn.bayes module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#methods-for-dealing-with-bayesian-statistics">Methods for dealing with Bayesian statistics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.dsp">nmmn.dsp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#signal-processing">Signal processing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.fermi">nmmn.fermi module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#methods-to-handle-fermi-lat-data">Methods to handle Fermi LAT data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.grmhd">nmmn.grmhd module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dealing-with-gr-r-m-hd-simulations">Dealing with (GR)(R)(M)HD simulations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.lsd">nmmn.lsd module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lsd-operations-lists-sets-dictionaries-and-arrays">LSD operations = lists, sets, dictionaries (and arrays)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.misc">nmmn.misc module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#miscelaneous-methods">Miscelaneous methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.plots">nmmn.plots module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fancy-plots">Fancy plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.sed">nmmn.sed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectral-energy-distributions">Spectral energy distributions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn.stats">nmmn.stats module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#statistical-methods">Statistical methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nmmn">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">nmmn</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Author.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/nmmn.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>